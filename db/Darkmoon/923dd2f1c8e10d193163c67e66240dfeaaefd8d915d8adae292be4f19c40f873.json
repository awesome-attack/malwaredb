{
    "alias": "Darkmoon", 
    "analysis": {
        "_id": {
            "$oid": "5ba55462ba80ffe26b515007"
        }, 
        "description": "PE32 executable (GUI) Intel 80386, for MS Windows", 
        "file_id": "ca2446d4b4cc283cccb8cfea2c1a720a81d69399", 
        "fuzzy_hash": "1536:TyqsmQRgN+8RBx6pSBXytqr2lw/aV32cMQrU:ym7vsKCtIgR2cMQrU", 
        "hash": {
            "md5": "652c22e59e0bea23348c5ed97d248ddf", 
            "sha1": "ca2446d4b4cc283cccb8cfea2c1a720a81d69399", 
            "sha2": "923dd2f1c8e10d193163c67e66240dfeaaefd8d915d8adae292be4f19c40f873"
        }, 
        "mime_type": "application/x-dosexec", 
        "particular_header": {
            "av_analysis": "Not_implemented", 
            "certificate": {}, 
            "child_of": "Not_implemented", 
            "cypher": "Not_implemented", 
            "date": "'0x2A425E19 [SUSPICIOUS]'", 
            "ep": "'0x40c670 CODE 0/8'", 
            "exports": {}, 
            "file_entropy": 6.320289195270141, 
            "headers": {
                "dos_header": {
                    "cblp": "'0x50'", 
                    "cp": "'0x2'", 
                    "cparhdr": "'0x4'", 
                    "crlc": "'0x0'", 
                    "cs": "'0x0'", 
                    "csum": "'0x0'", 
                    "ip": "'0x0'", 
                    "lfanew": "'0x100'", 
                    "lfarlc": "'0x40'", 
                    "magic": "'0x5a4d'", 
                    "maxalloc": "'0xffff'", 
                    "minalloc": "'0xf'", 
                    "oemid": "'0x0'", 
                    "oeminfo": "'0x0'", 
                    "ovno": "'0x1a'", 
                    "res": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "res2": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "sp": "'0xb8'", 
                    "ss": "'0x0'"
                }, 
                "file_header": {
                    "Characteristics": "'0x818e'", 
                    "Machine": "'0x14c'", 
                    "NumberOfSections": "'0x8'", 
                    "NumberOfSymbols": "'0x0'", 
                    "PointerToSymbolTable": "'0x0'", 
                    "SizeOfOptionalHeader": "'0xe0'", 
                    "TimeDateStamp": "'0x2a425e19'"
                }, 
                "nt_header": {
                    "Signature": "'0x4550'"
                }, 
                "optional_header": {
                    "AddressOfEntryPoint": "'0xc670'", 
                    "BaseOfCode": "'0x1000'", 
                    "CheckSum": "'0x0'", 
                    "DllCharacteristics": "'0x0'", 
                    "FileAlignment": "'0x200'", 
                    "ImageBase": "'0x400000'", 
                    "LoaderFlags": "'0x0'", 
                    "Magic": "'0x10b'", 
                    "MajorImageVersion": "'0x0'", 
                    "MajorLinkerVersion": "'0x2'", 
                    "MajorOperatingSystemVersion": "'0x4'", 
                    "MajorSubsystemVersion": "'0x4'", 
                    "MinorImageVersion": "'0x0'", 
                    "MinorLinkerVersion": "'0x19'", 
                    "MinorOperatingSystemVersion": "'0x0'", 
                    "MinorSubsystemVersion": "'0x0'", 
                    "NumberOfRvaAndSizes": "'0x10'", 
                    "Reserved1": "'0x0'", 
                    "SectionAlignment": "'0x1000'", 
                    "SizeOfCode": "'0xbc00'", 
                    "SizeOfHeaders": "'0x400'", 
                    "SizeOfHeapCommit": "'0x1000'", 
                    "SizeOfHeapReserve": "'0x100000'", 
                    "SizeOfImage": "'0x15000'", 
                    "SizeOfInitializedData": "'0x2600'", 
                    "SizeOfStackCommit": "'0x4000'", 
                    "SizeOfStackReserve": "'0x100000'", 
                    "SizeOfUninitializedData": "'0x0'", 
                    "Subsystem": "'0x2'"
                }
            }, 
            "imports": [
                {
                    "functions": [
                        "'deletecriticalsection'", 
                        "'leavecriticalsection'", 
                        "'entercriticalsection'", 
                        "'initializecriticalsection'", 
                        "'virtualfree'", 
                        "'virtualalloc'", 
                        "'localfree'", 
                        "'localalloc'", 
                        "'getversion'", 
                        "'getcurrentthreadid'", 
                        "'getthreadlocale'", 
                        "'getstartupinfoa'", 
                        "'getmodulefilenamea'", 
                        "'getlocaleinfoa'", 
                        "'getlasterror'", 
                        "'getcommandlinea'", 
                        "'freelibrary'", 
                        "'createdirectorya'", 
                        "'exitprocess'", 
                        "'createthread'", 
                        "'writefile'", 
                        "'unhandledexceptionfilter'", 
                        "'setfilepointer'", 
                        "'setendoffile'", 
                        "'rtlunwind'", 
                        "'readfile'", 
                        "'raiseexception'", 
                        "'movefilea'", 
                        "'getstdhandle'", 
                        "'getfilesize'", 
                        "'getfiletype'", 
                        "'createfilea'", 
                        "'closehandle'"
                    ], 
                    "lib": "'kernel32.dll'"
                }, 
                {
                    "functions": [
                        "'getkeyboardtype'", 
                        "'messageboxa'", 
                        "'charnexta'"
                    ], 
                    "lib": "'user32.dll'"
                }, 
                {
                    "functions": [
                        "'regqueryvalueexa'", 
                        "'regopenkeyexa'", 
                        "'regclosekey'"
                    ], 
                    "lib": "'advapi32.dll'"
                }, 
                {
                    "functions": [
                        "'sysfreestring'"
                    ], 
                    "lib": "'oleaut32.dll'"
                }, 
                {
                    "functions": [
                        "'tlssetvalue'", 
                        "'tlsgetvalue'", 
                        "'localalloc'", 
                        "'getmodulehandlea'"
                    ], 
                    "lib": "'kernel32.dll'"
                }, 
                {
                    "functions": [
                        "'regsetvalueexa'", 
                        "'regopenkeyexa'", 
                        "'regclosekey'", 
                        "'getusernamea'"
                    ], 
                    "lib": "'advapi32.dll'"
                }, 
                {
                    "functions": [
                        "'terminateprocess'", 
                        "'sleep'", 
                        "'setfileattributesa'", 
                        "'setcurrentdirectorya'", 
                        "'readfile'", 
                        "'openprocess'", 
                        "'loadlibrarya'", 
                        "'getwindowsdirectorya'", 
                        "'getvolumeinformationa'", 
                        "'getversionexa'", 
                        "'gettimeformata'", 
                        "'getprocaddress'", 
                        "'getmodulehandlea'", 
                        "'getfileattributesa'", 
                        "'getdateformata'", 
                        "'freelibrary'", 
                        "'findnextfilea'", 
                        "'findfirstfilea'", 
                        "'findclose'", 
                        "'filetimetolocalfiletime'", 
                        "'filetimetodosdatetime'", 
                        "'deletefilea'", 
                        "'createthread'", 
                        "'copyfilea'", 
                        "'closehandle'"
                    ], 
                    "lib": "'kernel32.dll'"
                }, 
                {
                    "functions": [
                        "'createfonta'"
                    ], 
                    "lib": "'gdi32.dll'"
                }, 
                {
                    "functions": [
                        "'createwindowexa'", 
                        "'mouse_event'", 
                        "'keybd_event'", 
                        "'updatewindow'", 
                        "'translatemessage'", 
                        "'showwindow'", 
                        "'setwindowtexta'", 
                        "'setfocus'", 
                        "'setcursorpos'", 
                        "'sendmessagea'", 
                        "'registerclassa'", 
                        "'postmessagea'", 
                        "'messageboxa'", 
                        "'loadcursora'", 
                        "'getwindowtextlengtha'", 
                        "'getwindowtexta'", 
                        "'getmessagea'", 
                        "'getkeystate'", 
                        "'getforegroundwindow'", 
                        "'getdesktopwindow'", 
                        "'getasynckeystate'", 
                        "'dispatchmessagea'", 
                        "'defwindowproca'"
                    ], 
                    "lib": "'user32.dll'"
                }, 
                {
                    "functions": [
                        "'wsacleanup'", 
                        "'wsastartup'", 
                        "'wsagetlasterror'", 
                        "'wsaasyncselect'", 
                        "'gethostname'", 
                        "'gethostbyname'", 
                        "'socket'", 
                        "'shutdown'", 
                        "'send'", 
                        "'recv'", 
                        "'listen'", 
                        "'ioctlsocket'", 
                        "'inet_ntoa'", 
                        "'inet_addr'", 
                        "'htons'", 
                        "'htonl'", 
                        "'connect'", 
                        "'closesocket'", 
                        "'bind'", 
                        "'accept'"
                    ], 
                    "lib": "'wsock32.dll'"
                }, 
                {
                    "functions": [
                        "'shellexecutea'", 
                        "'shfileoperationa'"
                    ], 
                    "lib": "'shell32.dll'"
                }, 
                {
                    "functions": [
                        "'internetsetstatuscallback'", 
                        "'internetreadfile'", 
                        "'internetopenurla'", 
                        "'internetopena'", 
                        "'internetconnecta'", 
                        "'internetclosehandle'", 
                        "'ftpputfilea'", 
                        "'ftpcreatedirectorya'"
                    ], 
                    "lib": "'wininet.dll'"
                }, 
                {
                    "functions": [
                        "'capcreatecapturewindowa'"
                    ], 
                    "lib": "'avicap32.dll'"
                }
            ], 
            "imports_tree": "added", 
            "packer_detection": "Unknown", 
            "packer_version": "Not_implemented", 
            "res_entries": [
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x14198'", 
                    "sha1": "d6fc4edac0bdb9cf081ad178589b59506906516f", 
                    "size": "'0x2e8'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'dBase IV DBT of @.DBF, block length 512, next free block index 40, next free block 49, next used block 48059'"
                }, 
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_RCDATA'", 
                    "rva": "'0x14480'", 
                    "sha1": "878d9571bc23518bb1c6d6ad240326357c1a472e", 
                    "size": "'0xc'", 
                    "sublang": "'SUBLANG_NEUTRAL'", 
                    "type": "'data'"
                }, 
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_RCDATA'", 
                    "rva": "'0x1448c'", 
                    "sha1": "04f73efb0801b18f6984b14cd057fb56519cd31b", 
                    "size": "'0x10'", 
                    "sublang": "'SUBLANG_NEUTRAL'", 
                    "type": "'Sendmail frozen configuration '"
                }, 
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_RCDATA'", 
                    "rva": "'0x1449c'", 
                    "sha1": "b74cc5d203966d29c4c4bb4056ab7b31d1230cc3", 
                    "size": "'0xc4'", 
                    "sublang": "'SUBLANG_NEUTRAL'", 
                    "type": "'data'"
                }, 
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_GROUP_ICON'", 
                    "rva": "'0x14560'", 
                    "sha1": "cf9a68a0b175f131381d3d29245441a6f9d53e3d", 
                    "size": "'0x14'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'MS Windows icon resource - 1 icon, 32x32, 4 colors'"
                }
            ], 
            "sections": [
                {
                    "characteristics": "0x60000020", 
                    "entropy": 6.310740175380174, 
                    "fuzzy_hash": "768:ByhcqsmQRgNxI8Rqo3x6pSJb/Py/W6qraxyCXfRLLwvHaVY09uzDT05ijH:4yqsmQRgN+8RBx6pSBXytqr2lw/aV32", 
                    "md5": "4f321143645c54cd6cdeaf87cf91d950", 
                    "name": "'CODE\\x00\\x00\\x00\\x00'", 
                    "sha1": "5b48a8e7addea08d3d6a4529b7ea3b8f545b8b4d", 
                    "sha2": "53526f2f0945bccf036e31ce165dae1b7efb597201db087ec8ba189f4624ac62", 
                    "size_raw_data": 48128, 
                    "virtual_size": 47644, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0xc0000040", 
                    "entropy": 3.4434824746051493, 
                    "fuzzy_hash": "6:Y/nCnlPDUtZXM+p/SjhcOgq10tXw4vmkCNMvWdd:YQADSVcOgq1091mkCNMvW3", 
                    "md5": "08339786486973814dbec61ed46b5ddd", 
                    "name": "'DATA\\x00\\x00\\x00\\x00'", 
                    "sha1": "08b8507c108a1fad107241ff157c1ed08a5286ba", 
                    "sha2": "053cdc9c06070852aa51330f445a0ded9457e8228dd8b12021ff5e247908ee3e", 
                    "size_raw_data": 512, 
                    "virtual_size": 496, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0xc0000000", 
                    "entropy": 0.0, 
                    "fuzzy_hash": "3::", 
                    "md5": "d41d8cd98f00b204e9800998ecf8427e", 
                    "name": "'BSS\\x00\\x00\\x00\\x00\\x00'", 
                    "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709", 
                    "sha2": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855", 
                    "size_raw_data": 0, 
                    "virtual_size": 4721, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0xc0000040", 
                    "entropy": 4.372225983766873, 
                    "fuzzy_hash": "96:1MmXRVXK3FlesnJNbKA7ZSKETG4EHbmV:2mXRVXK3jLn/bKA7sKETtV", 
                    "md5": "063ec6a20e4e000cec6a8c648bb4392f", 
                    "name": "'.idata\\x00\\x00'", 
                    "sha1": "6a7eb5f70c5fda3ab7a8e0173c07b734c0df3aee", 
                    "sha2": "9a4f4bc08238c7ee01dd12c03fe72f5a79cbae00c958139ac419dcead3a3a18e", 
                    "size_raw_data": 3584, 
                    "virtual_size": 3122, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0xc0000000", 
                    "entropy": 0.0, 
                    "fuzzy_hash": "3::", 
                    "md5": "d41d8cd98f00b204e9800998ecf8427e", 
                    "name": "'.tls\\x00\\x00\\x00\\x00'", 
                    "sha1": "da39a3ee5e6b4b0d3255bfef95601890afd80709", 
                    "sha2": "e3b0c44298fc1c149afbf4c8996fb92427ae41e4649b934ca495991b7852b855", 
                    "size_raw_data": 0, 
                    "virtual_size": 8, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0x50000040", 
                    "entropy": 0.2843734635768694, 
                    "fuzzy_hash": "3:FKl/ltpX:F+/", 
                    "md5": "91cc1aa185e440e420166de1ff6004f7", 
                    "name": "'.rdata\\x00\\x00'", 
                    "sha1": "5354e97aef168604ff6de0b80c4d30eb3d52ee96", 
                    "sha2": "f5636cff69c270d42f2e9991e0a30eabc6b51808f147659e5dd0663419ba2f5f", 
                    "size_raw_data": 512, 
                    "virtual_size": 30, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0x50000040", 
                    "entropy": 6.576638272369476, 
                    "fuzzy_hash": "96:BZiQpJCLKR/+okXGfe6IpBQa47pt6zX6t+GlTWs+:ecaKsokXIe6IXMpLDlTh", 
                    "md5": "3d6ea750d4de5b27a5816c12e2cceed3", 
                    "name": "'.reloc\\x00\\x00'", 
                    "sha1": "4c4e9cadc3a542cb0a9b6e51089aef644c256a13", 
                    "sha2": "d0097cafb325848bb61411b3fc79e58e3e9cdb297e3831d2b0b920b74194fa12", 
                    "size_raw_data": 3584, 
                    "virtual_size": 3324, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0x50000040", 
                    "entropy": 4.065887543384413, 
                    "fuzzy_hash": "24:VwFsGlEiux2Q2i3JsgXL1KcfplAU18TXw:iFut2iZsgUczA/", 
                    "md5": "b08ee1d6b24339030fd321a2b12a941e", 
                    "name": "'.rsrc\\x00\\x00\\x00'", 
                    "sha1": "1f1acaedbd761165c1b52374ef1543bff46bc163", 
                    "sha2": "508790b5a5da4ff42819d81ab3f00fba2addb492a40cf4fd76658fe1c2fad448", 
                    "size_raw_data": 1536, 
                    "virtual_size": 1536, 
                    "write_executable": "False"
                }
            ], 
            "strings": {
                "domains": [
                    "'t.ht'", 
                    "'win32log.dat'"
                ], 
                "emails": [
                    "'hola@hotmail.com'"
                ], 
                "hidden_imports": [
                    "'createtoolhelp32snapshot'", 
                    "'escape'", 
                    "'process32first'", 
                    "'process32next'", 
                    "'wsprintfa'"
                ], 
                "interesting": [
                    "'.exe'", 
                    "'av.exe'", 
                    "'microsoft.exe'", 
                    "'net.exe'", 
                    "'unistallserver8989.dll'", 
                    "'win32.exe'"
                ], 
                "ips": [
                    "'127.0.0.1'"
                ], 
                "raw_strings": [
                    "'                                                                '", 
                    "' service pack: '", 
                    "' stop sharedaccess'", 
                    "' u-3'", 
                    "' vws'", 
                    "'$)d$'", 
                    "'%darkmoon%'", 
                    "'&=o8'", 
                    "'&vvggd'", 
                    "',-./0123'", 
                    "',00040'", 
                    "'.0[0'", 
                    "'.exe'", 
                    "'.txt'", 
                    "'0&0.060>0f0n0v0'", 
                    "'0&0d0j0r0'", 
                    "'0123456789abcdef'", 
                    "'080=0j0o0'", 
                    "'0?1e1'", 
                    "'0a0n0s0'", 
                    "'0f0n0v0'", 
                    "'0f3o3'", 
                    "'1.1r1z1'", 
                    "'121:1b1j1r1z1b1k1'", 
                    "'127.0.0.1'", 
                    "'151a1m1g1'", 
                    "'1]2h2q2w2'", 
                    "'1b1h1r1'", 
                    "'1f1k1'", 
                    "'1l1s1x1'", 
                    "'1rwr'", 
                    "'1wwwr'", 
                    "'2 2-23282b2m2]2m2'", 
                    "'2/2>2'", 
                    "'232g2s2'", 
                    "'242j2w2'", 
                    "'262c2'", 
                    "'2]3m3s3x3'", 
                    "'2e2t2'", 
                    "'3%3-3:3b3o3w3b3g3'", 
                    "'3/3u3h3p3'", 
                    "'3333'", 
                    "'33331'", 
                    "'33333'", 
                    "'3=3m3'", 
                    "'3messages'", 
                    "'4$4,4h4y4d4j4s4'", 
                    "'4$5e5'", 
                    "'4000'", 
                    "'424<4f4p4z4d4n4x4'", 
                    "'444e4k4p4b4'", 
                    "'444i4q4'", 
                    "'4a5]5'", 
                    "'4i4y4o4'", 
                    "'4m5b5'", 
                    "'4w4j4'", 
                    "'5,565@5j5t5'", 
                    "'525:5p5h5v5'", 
                    "'555f5[5h5'", 
                    "'556s6'", 
                    "'5:5o5'", 
                    "'5>5f5s5'", 
                    "'5?5i5v5'", 
                    "'5h5r5'", 
                    "'6 6$6(6,6064686<6@6d6h6l6p6t6x6'", 
                    "'6&757:7a7'", 
                    "'6/7g7r7'", 
                    "'696c6'", 
                    "'697f7t7a7n7'", 
                    "'6>7e7w7u7'", 
                    "'6d6l6'", 
                    "'6n6r6'", 
                    "'7&7,787=7h7o7t7'", 
                    "'7(787r7j7z7'", 
                    "'7(8n8n8'", 
                    "'7-8o8[8b8l8v8'", 
                    "'7.7i7w7'", 
                    "'757=7'", 
                    "'7o7w7'", 
                    "'8(8.868a8i8z8p8'", 
                    "'8-878m8s8a8t8'", 
                    "'868e8t8a8j8o8w8'", 
                    "'8]9a9e9i9m9q9u9y9'", 
                    "'8v8o8'", 
                    "'9 9)9.9@9e9w9'", 
                    "'9&909:9d9p9[9l9r9z9'", 
                    "'9(999u9'", 
                    "'959e9b9z9'", 
                    "'9:9o9'", 
                    "'9_9z9'", 
                    "'9beast'", 
                    "'9d9k9r9b:w:'", 
                    "'9d9o9'", 
                    "'9j9r9z9'", 
                    "'9s9]9b9o9'", 
                    "':$:6:a:[:e:s:'", 
                    "':):::f:k:p:w:'", 
                    "':-:?:q:c:u:'", 
                    "':1:i:y:v:'", 
                    "':::o:u:'", 
                    "':d:i:p:v:'", 
                    "':uregister'", 
                    "':v:z:'", 
                    "'<&<s<x<]<e<'", 
                    "'<---------------------------------'", 
                    "'<1<t<'", 
                    "'<2<:<b<j<r<z<b<j<r<z<'", 
                    "'<8<k<q<'", 
                    "'<:<r<b<'", 
                    "'<c=o='", 
                    "'<h=p='", 
                    "'<ucmd'", 
                    "'=,=6=@=j=t='", 
                    "'=.=6=s=]=g=o='", 
                    "'=<>b>l>u>c>j>o>'", 
                    "'=h=r='", 
                    "'=j>p>'", 
                    "'>$>k>'", 
                    "'>%>4>>>n>'", 
                    "'>&>.>'", 
                    "'>(>.>i>t>z>'", 
                    "'>0?l?[?e?u?'", 
                    "'>@>x>'", 
                    "'>[>f>'", 
                    "'>g>t>f>n>v>'", 
                    "'>uftpwininet'", 
                    "'?&?3???l?'", 
                    "'?456789:'", 
                    "'?6?o?'", 
                    "'?8???d?o?a?y?'", 
                    "'?f?t?'", 
                    "'?q?v?'", 
                    "'?wininet'", 
                    "'@j)h'", 
                    "'@j1h'", 
                    "'[yy]'", 
                    "'av.exe'", 
                    "'back'", 
                    "'borland'", 
                    "'button'", 
                    "'c$,0@'", 
                    "'capturewindow'", 
                    "'chat'", 
                    "'createtoolhelp32snapshot'", 
                    "'currentvers'", 
                    "'d$,1'", 
                    "'d$@ph'", 
                    "'darkmoon'", 
                    "'data'", 
                    "'ddd_mmm_dd_yyyy'", 
                    "'ddddd'", 
                    "'ddddddd'", 
                    "'delphi'", 
                    "'dir created: '", 
                    "'dminf'", 
                    "'dmpasswrong'", 
                    "'edit'", 
                    "'error on making the dir: '", 
                    "'error'", 
                    "'escape'", 
                    "'exit'", 
                    "'false'", 
                    "'file coulnt be renamed: '", 
                    "'file deleted: '", 
                    "'file renamed to: '", 
                    "'file'", 
                    "'fmfinished'", 
                    "'fpumaskvalue'", 
                    "'from: '", 
                    "'fvvd'", 
                    "'gfku'", 
                    "'gggfv@'", 
                    "'gmmsystem'", 
                    "'h$q@'", 
                    "'h,x@'", 
                    "'h.t@'", 
                    "'h.y@'", 
                    "'h/b@'", 
                    "'h8x@'", 
                    "'h@b@'", 
                    "'h@q@'", 
                    "'hah@'", 
                    "'hc @'", 
                    "'hc[@'", 
                    "'heap32first'", 
                    "'heap32listfirst'", 
                    "'heap32listnext'", 
                    "'heap32next'", 
                    "'helo test'", 
                    "'hh-mm-ss-tt'", 
                    "'hh_@'", 
                    "'hhh@'", 
                    "'hht@'", 
                    "'hhw@'", 
                    "'hidden'", 
                    "'hki@'", 
                    "'hlr@'", 
                    "'hlx@'", 
                    "'hola@hotmail.com'", 
                    "'hoz@'", 
                    "'hpq@'", 
                    "'hqz@'", 
                    "'ht ht.'", 
                    "'hth@'", 
                    "'htwh'", 
                    "'hxh@'", 
                    "'hxo@'", 
                    "'hxx@'", 
                    "'it2s'", 
                    "'j(h,'", 
                    "'kwindows'", 
                    "'kxi[)'", 
                    "'list '", 
                    "'local disk'", 
                    "'local'", 
                    "'lzexpand'", 
                    "'mail from: '", 
                    "'master'", 
                    "'microsoft bill gates'", 
                    "'microsoft'", 
                    "'microsoft.exe'", 
                    "'module32first'", 
                    "'module32firstw'", 
                    "'module32next'", 
                    "'module32nextw'", 
                    "'ms sans serif'", 
                    "'net.exe'", 
                    "'nick name:'", 
                    "'normal'", 
                    "'only read'", 
                    "'open'", 
                    "'ph4y@'", 
                    "'pjxj'", 
                    "'pprtj'", 
                    "'process32first'", 
                    "'process32firstw'", 
                    "'process32next'", 
                    "'process32nextw'", 
                    "'psvw'", 
                    "'pwvj'", 
                    "'qqqqqqs'", 
                    "'qqqqqsv'", 
                    "'qqqqqsv3'", 
                    "'qsvw'", 
                    "'qsvw3'", 
                    "'quit'", 
                    "'r/f='", 
                    "'r6t0'", 
                    "'rcpt to: '", 
                    "'runtime error     at 00000000'", 
                    "'shellapi'", 
                    "'software'", 
                    "'sprq'", 
                    "'startlistfm'", 
                    "'static'", 
                    "'string'", 
                    "'subject: testing'", 
                    "'svw3'", 
                    "'svwq'", 
                    "'svwrp'", 
                    "'svwu'", 
                    "'svwuq'", 
                    "'sysinit'", 
                    "'system'", 
                    "'t$(j'", 
                    "'t.ht'", 
                    "'t=htn'", 
                    "'temp'", 
                    "'thread32first'", 
                    "'thread32next'", 
                    "'tlhelp32'", 
                    "'toolhelp32readprocessmemory'", 
                    "'true'", 
                    "'u:hd'", 
                    "'u:jt'", 
                    "'uajt'", 
                    "'uftpunit'", 
                    "'uh(b@'", 
                    "'uh::@'", 
                    "'uh:h@'", 
                    "'uh<[@'", 
                    "'uha_@'", 
                    "'uhah@'", 
                    "'uhat@'", 
                    "'uhaw@'", 
                    "'uhdi@'", 
                    "'uher@'", 
                    "'uhhz@'", 
                    "'uhjz@'", 
                    "'uhqo@'", 
                    "'uhyn@'", 
                    "'uhyv@'", 
                    "'unistallserver8989.dll'", 
                    "'utils'", 
                    "'utypes'", 
                    "'uxjt'", 
                    "'v)f='", 
                    "'v-f='", 
                    "'v<_<'", 
                    "'vwud'", 
                    "'w)f%'", 
                    "'win32.exe'", 
                    "'win32chat'", 
                    "'win32log.dat'", 
                    "'windows platform: unknown'", 
                    "'windows system:   2000'", 
                    "'windows system:   3.11'", 
                    "'windows system:   95'", 
                    "'windows system:   98 se'", 
                    "'windows system:   98'", 
                    "'windows system:   millenium'", 
                    "'windows system:   unknown'", 
                    "'windows system:   whistler'", 
                    "'windows system:   windows nt'", 
                    "'windows system:   xp'", 
                    "'windows'", 
                    "'winsock'", 
                    "'winsvc'", 
                    "'wsprintfa'", 
                    "'wwgbvt'", 
                    "'yyzx'", 
                    "'yz]_'", 
                    "'yzxt5'", 
                    "'yzxtp'", 
                    "'yzxu'", 
                    "'zyyd'"
                ]
            }, 
            "version": {}
        }, 
        "size": 58880
    }, 
    "attack-pattern": [
        {
            "created": "2017-05-31T21:30:49.546Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Command-line interfaces provide a way of interacting with computer systems and is a common feature across many types of operating system platforms. (Citation: Wikipedia Command-Line Interface) One example command-line interface on Windows systems is cmd, which can be used to perform a number of tasks including execution of other software. Command-line interfaces can be interacted with locally or remotely via a remote desktop application, reverse shell session, etc. Commands that are executed run with the current permission level of the command-line interface process unless the command includes process invocation that changes permissions context for that execution (e.g. Scheduled Task).\n\nAdversaries may use command-line interfaces to interact with systems and execute other software during the course of an operation.\n\nDetection: Command-line interface activities can be captured through proper logging of process execution with command-line arguments. This information can be useful in gaining additional insight to adversaries' actions through how they use native processes or custom tools.\n\nPlatforms: Linux, Windows, macOS\n\nData Sources: Process command-line parameters, Process monitoring\n\nPermissions Required: Administrator, SYSTEM, User\n\nRemote Support: No", 
            "external_references": [
                {
                    "external_id": "T1059", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1059"
                }, 
                {
                    "description": "Wikipedia. (2016, June 26). Command-line interface. Retrieved June 27, 2016.", 
                    "source_name": "Wikipedia Command-Line Interface", 
                    "url": "https://en.wikipedia.org/wiki/Command-line%20interface"
                }
            ], 
            "id": "attack-pattern--7385dfaf-6886-4229-9ecd-6fd678040830", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "execution"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Command-Line Interface", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Process command-line parameters", 
                "Process monitoring"
            ], 
            "x_mitre_permissions_required": [
                "Administrator", 
                "SYSTEM", 
                "User"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "Windows", 
                "macOS"
            ], 
            "x_mitre_remote_support": false
        }, 
        {
            "created": "2017-05-31T21:30:49.988Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adding an entry to the \"run keys\" in the Registry or startup folder will cause the program referenced to be executed when a user logs in. (Citation: Microsoft Run Key) The program will be executed under the context of the user and will have the account's associated permissions level.\n\nAdversaries can use these configuration locations to execute malware, such as remote access tools, to maintain persistence through system reboots. Adversaries may also use Masquerading to make the Registry entries look as if they are associated with legitimate programs.\n\nDetection: Monitor Registry for changes to run keys that do not correlate with known software, patch cycles, etc. Monitor the start folder for additions or changes. Tools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence, including listing the run keys' Registry locations and startup folders. (Citation: TechNet Autoruns) Suspicious program execution as startup programs may show up as outlier processes that have not been seen before when compared against historical data.\n\nChanges to these locations typically happen under normal conditions when legitimate software is installed. To increase confidence of malicious activity, data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\n\nPlatforms: Windows\n\nData Sources: Windows Registry, File monitoring\n\nPermissions Required: User, Administrator", 
            "external_references": [
                {
                    "external_id": "T1060", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1060"
                }, 
                {
                    "description": "Microsoft. (n.d.). Run and RunOnce Registry Keys. Retrieved November 12, 2014.", 
                    "source_name": "Microsoft Run Key", 
                    "url": "http://msdn.microsoft.com/en-us/library/aa376977"
                }, 
                {
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.", 
                    "source_name": "TechNet Autoruns", 
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }
            ], 
            "id": "attack-pattern--9422fc14-1c43-410d-ab0f-a709b76c72dc", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "persistence"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Registry Run Keys / Start Folder", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Windows Registry", 
                "File monitoring"
            ], 
            "x_mitre_permissions_required": [
                "User", 
                "Administrator"
            ], 
            "x_mitre_platforms": [
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:32.662Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries may attempt to make an executable or file difficult to discover or analyze by encrypting, encoding, or otherwise obfuscating its contents on the system or in transit. This is common behavior that can be used across different platforms and the network to evade defenses.\n\nPayloads may be compressed, archived, or encrypted in order to avoid detection. These payloads may be used during Initial Access or later to mitigate detection. Sometimes a user's action may be required to open and Deobfuscate/Decode Files or Information for User Execution. The user may also be required to input a password to open a password protected compressed/encrypted file that was provided by the adversary. (Citation: Volexity PowerDuke November 2016) Adversaries may also used compressed or archived scripts, such as Javascript.\n\nPortions of files can also be encoded to hide the plain-text strings that would otherwise help defenders with discovery. (Citation: Linux/Cdorked.A We Live Security Analysis) Payloads may also be split into separate, seemingly benign files that only reveal malicious functionality when reassembled. (Citation: Carbon Black Obfuscation Sept 2016)\n\nAdversaries may also obfuscate commands executed from payloads or directly via a Command-Line Interface. Environment variables, aliases, characters, and other platform/language specific semantics can be used to evade signature based detections and whitelisting mechanisms. (Citation: FireEye Obfuscation June 2017) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: PaloAlto EncodedCommand March 2017)\n\nAnother example of obfuscation is through the use of steganography, a technique of hiding messages or code in images, audio tracks, video clips, or text files. One of the first known and reported adversaries that used steganography activity surrounding Invoke-PSImage. The Duqu malware encrypted the gathered information from a victim's system and hid it into an image followed by exfiltrating the image to a C2 server. (Citation: Wikipedia Duqu) By the end of 2017, an adversary group used Invoke-PSImage to hide PowerShell commands in an image file (png) and execute the code on a victim's system. In this particular case the PowerShell code downloaded another obfuscated script to gather intelligence from the victim's machine and communicate it back to the adversary. (Citation: McAfee Malicious Doc Targets Pyeongchang Olympics)\n\nDetection: Detection of file obfuscation is difficult unless artifacts are left behind by the obfuscation process that are uniquely detectable with a signature. If detection of the obfuscation itself is not possible, it may be possible to detect the malicious activity that caused the obfuscated file (for example, the method that was used to write, read, or modify the file on the file system).\n\nFlag and analyze commands containing indicators of obfuscation and known suspicious syntax such as uninterpreted escape characters like '''^''' and '''\"'''. Windows' Sysmon and Event ID 4688 displays command-line arguments for processes. Deobfuscation tools can be used to detect these indicators in files/payloads. (Citation: GitHub Revoke-Obfuscation) (Citation: FireEye Revoke-Obfuscation July 2017) (Citation: GitHub Office-Crackros Aug 2016)\n\nObfuscation used in payloads for Initial Access can be detected at the network. Use network intrusion detection systems and email gateway filtering to identify compressed and encrypted attachments and scripts. Some email attachment detonation systems can open compressed and encrypted attachments. Payloads delivered over an encrypted connection from a website require encrypted network traffic inspection.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: Network protocol analysis, Process use of network, Binary file metadata, File monitoring, Malware reverse engineering, Process command-line parameters, Environment variable, Process Monitoring, Windows event logs, Network intrusion detection system, Email gateway, SSL/TLS inspection\n\nDefense Bypassed: Host forensic analysis, Signature-based detection, Host intrusion prevention systems, Application whitelisting, Process whitelisting, Log analysis, Whitelisting by file name or path\n\nContributors: Red Canary, Christiaan Beek, @ChristiaanBeek", 
            "external_references": [
                {
                    "external_id": "T1027", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1027"
                }, 
                {
                    "description": "Adair, S.. (2016, November 9). PowerDuke: Widespread Post-Election Spear Phishing Campaigns Targeting Think Tanks and NGOs. Retrieved January 11, 2017.", 
                    "source_name": "Volexity PowerDuke November 2016", 
                    "url": "https://www.volexity.com/blog/2016/11/09/powerduke-post-election-spear-phishing-campaigns-targeting-think-tanks-and-ngos/"
                }, 
                {
                    "description": "Pierre-Marc Bureau. (2013, April 26). Linux/Cdorked.A: New Apache backdoor being used in the wild to serve Blackhole. Retrieved September 10, 2017.", 
                    "source_name": "Linux/Cdorked.A We Live Security Analysis", 
                    "url": "https://www.welivesecurity.com/2013/04/26/linuxcdorked-new-apache-backdoor-in-the-wild-serves-blackhole/"
                }, 
                {
                    "description": "Tedesco, B. (2016, September 23). Security Alert Summary. Retrieved February 12, 2018.", 
                    "source_name": "Carbon Black Obfuscation Sept 2016", 
                    "url": "https://www.carbonblack.com/2016/09/23/security-advisory-variants-well-known-adware-families-discovered-include-sophisticated-obfuscation-techniques-previously-associated-nation-state-attacks/"
                }, 
                {
                    "description": "Bohannon, D. & Carr N. (2017, June 30). Obfuscation in the Wild: Targeted Attackers Lead the Way in Evasion Techniques. Retrieved February 12, 2018.", 
                    "source_name": "FireEye Obfuscation June 2017", 
                    "url": "https://www.fireeye.com/blog/threat-research/2017/06/obfuscation-in-the-wild.html"
                }, 
                {
                    "description": "Bohannon, D. & Holmes, L. (2017, July 27). Revoke-Obfuscation: PowerShell Obfuscation Detection Using Science. Retrieved February 12, 2018.", 
                    "source_name": "FireEye Revoke-Obfuscation July 2017", 
                    "url": "https://www.fireeye.com/content/dam/fireeye-www/blog/pdfs/revoke-obfuscation-report.pdf"
                }, 
                {
                    "description": "White, J. (2017, March 10). Pulling Back the Curtains on EncodedCommand PowerShell Attacks. Retrieved February 12, 2018.", 
                    "source_name": "PaloAlto EncodedCommand March 2017", 
                    "url": "https://researchcenter.paloaltonetworks.com/2017/03/unit42-pulling-back-the-curtains-on-encodedcommand-powershell-attacks/"
                }, 
                {
                    "description": "Wikipedia. (2017, December 29). Duqu. Retrieved April 10, 2018.", 
                    "source_name": "Wikipedia Duqu", 
                    "url": "https://en.wikipedia.org/wiki/Duqu"
                }, 
                {
                    "description": "Saavedra-Morales, J., Sherstobitoff, R. (2018, January 6). Malicious Document Targets Pyeongchang Olympics. Retrieved April 10, 2018.", 
                    "source_name": "McAfee Malicious Doc Targets Pyeongchang Olympics", 
                    "url": "https://securingtomorrow.mcafee.com/mcafee-labs/malicious-document-targets-pyeongchang-olympics/"
                }, 
                {
                    "description": "Bohannon, D. (2017, July 27). Revoke-Obfuscation. Retrieved February 12, 2018.", 
                    "source_name": "GitHub Revoke-Obfuscation", 
                    "url": "https://github.com/danielbohannon/Revoke-Obfuscation"
                }, 
                {
                    "description": "Carr, N. (2016, August 14). OfficeCrackros. Retrieved February 12, 2018.", 
                    "source_name": "GitHub Office-Crackros Aug 2016", 
                    "url": "https://github.com/itsreallynick/office-crackros"
                }
            ], 
            "id": "attack-pattern--b3d682b6-98f2-4fb0-aa3b-b4df007ca70a", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Obfuscated Files or Information", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "Red Canary", 
                "Christiaan Beek, @ChristiaanBeek"
            ], 
            "x_mitre_data_sources": [
                "Network protocol analysis", 
                "Process use of network", 
                "Binary file metadata", 
                "File monitoring", 
                "Malware reverse engineering", 
                "Process command-line parameters", 
                "Environment variable", 
                "Process Monitoring", 
                "Windows event logs", 
                "Network intrusion detection system", 
                "Email gateway", 
                "SSL/TLS inspection"
            ], 
            "x_mitre_defense_bypassed": [
                "Host forensic analysis", 
                "Signature-based detection", 
                "Host intrusion prevention systems", 
                "Application whitelisting", 
                "Process whitelisting", 
                "Log analysis", 
                "Whitelisting by file name or path"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:24.512Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries may attempt to get a listing of open application windows. Window listings could convey information about how the system is used or give context to information collected by a keylogger.\n\nIn Mac, this can be done natively with a small AppleScript script.\n\nDetection: System and network discovery techniques normally occur throughout an operation as an adversary learns the environment. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities based on the information obtained.\n\nMonitor processes and command-line arguments for actions that could be taken to gather system and network information. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.\n\nPlatforms: macOS, Windows\n\nData Sources: API monitoring, Process command-line parameters, Process monitoring\n\nPermissions Required: User", 
            "external_references": [
                {
                    "external_id": "T1010", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1010"
                }
            ], 
            "id": "attack-pattern--4ae4f953-fe58-4cc8-a327-33257e30a830", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "discovery"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Application Window Discovery", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "API monitoring", 
                "Process command-line parameters", 
                "Process monitoring"
            ], 
            "x_mitre_permissions_required": [
                "User"
            ], 
            "x_mitre_platforms": [
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:58.938Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Collected data is staged in a central location or directory prior to Exfiltration. Data may be kept in separate files or combined into one file through techniques such as Data Compressed or Data Encrypted.\n\nInteractive command shells may be used, and common functionality within cmd and bash may be used to copy data into a staging location.\n\nDetection: Processes that appear to be reading files from disparate locations and writing them to the same directory or file may be an indication of data being staged, especially if they are suspected of performing encryption or compression on the files.\n\nMonitor processes and command-line arguments for actions that could be taken to collect and combine files. Remote access tools with built-in features may interact directly with the Windows API to gather and copy to a location. Data may also be acquired and staged through Windows system management tools such as Windows Management Instrumentation and PowerShell.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: File monitoring, Process monitoring, Process command-line parameters", 
            "external_references": [
                {
                    "external_id": "T1074", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1074"
                }
            ], 
            "id": "attack-pattern--7dd95ff6-712e-4056-9626-312ea4ab4c5e", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "collection"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Data Staged", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "File monitoring", 
                "Process monitoring", 
                "Process command-line parameters"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:31:23.587Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries may interact with the Windows Registry to hide configuration information within Registry keys, remove information as part of cleaning up, or as part of other techniques to aid in Persistence and Execution.\n\nAccess to specific areas of the Registry depends on account permissions, some requiring administrator-level access. The built-in Windows command-line utility Reg may be used for local or remote Registry modification. (Citation: Microsoft Reg) Other tools may also be used, such as a remote access tool, which may contain functionality to interact with the Registry through the Windows API (see examples).\n\nThe Registry of a remote system may be modified to aid in execution of files as part of Lateral Movement. It requires the remote Registry service to be running on the target system. (Citation: Microsoft Remote) Often Valid Accounts are required, along with access to the remote system's Windows Admin Shares for RPC communication.\n\nDetection: Modifications to the Registry are normal and occur throughout typical use of the Windows operating system. Changes to Registry entries that load software on Windows startup that do not correlate with known software, patch cycles, etc., are suspicious, as are additions or changes to files within the startup folder. Changes could also include new services and modification of existing binary paths to point to malicious files. If a change to a service-related entry occurs, then it will likely be followed by a local or remote service start or restart to execute the file.\n\nMonitor processes and command-line arguments for actions that could be taken to change or delete information in the Registry. Remote access tools with built-in features may interact directly with the Windows API to gather information. Information may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell, which may require additional logging features to be configured in the operating system to collect necessary information for analysis.\n\nPlatforms: Windows\n\nData Sources: Windows Registry, File monitoring, Process monitoring, Process command-line parameters\n\nDefense Bypassed: Host forensic analysis\n\nPermissions Required: User, Administrator, SYSTEM\n\nContributors: Bartosz Jerzman, Travis Smith, Tripwire", 
            "external_references": [
                {
                    "external_id": "T1112", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1112"
                }, 
                {
                    "description": "Microsoft. (2012, April 17). Reg. Retrieved May 1, 2015.", 
                    "source_name": "Microsoft Reg", 
                    "url": "https://technet.microsoft.com/en-us/library/cc732643.aspx"
                }, 
                {
                    "description": "Microsoft. (n.d.). Enable the Remote Registry Service. Retrieved May 1, 2015.", 
                    "source_name": "Microsoft Remote", 
                    "url": "https://technet.microsoft.com/en-us/library/cc754820.aspx"
                }
            ], 
            "id": "attack-pattern--57340c81-c025-4189-8fa0-fc7ede51bae4", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Modify Registry", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "Bartosz Jerzman", 
                "Travis Smith, Tripwire"
            ], 
            "x_mitre_data_sources": [
                "Windows Registry", 
                "File monitoring", 
                "Process monitoring", 
                "Process command-line parameters"
            ], 
            "x_mitre_defense_bypassed": [
                "Host forensic analysis"
            ], 
            "x_mitre_permissions_required": [
                "User", 
                "Administrator", 
                "SYSTEM"
            ], 
            "x_mitre_platforms": [
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:31:16.408Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Files may be copied from one system to another to stage adversary tools or other files over the course of an operation. Files may be copied from an external adversary-controlled system through the Command and Control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync, and sftp.\n\nAdversaries may also copy files laterally between internal victim systems to support Lateral Movement with remote Execution using inherent file sharing protocols such as file sharing over SMB to connected network shares or with authenticated connections with Windows Admin Shares or Remote Desktop Protocol.\n\nDetection: Monitor for file creation and files transferred within a network over SMB. Unusual processes with external network connections creating files on-system may be suspicious. Use of utilities, such as FTP, that does not normally occur may also be suspicious.\n\nAnalyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: File monitoring, Packet capture, Process use of network, Netflow/Enclave netflow, Network protocol analysis, Process monitoring\n\nPermissions Required: User\n\nRequires Network: Yes", 
            "external_references": [
                {
                    "external_id": "T1105", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1105"
                }, 
                {
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", 
                    "source_name": "University of Birmingham C2", 
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ], 
            "id": "attack-pattern--e6919abc-99f9-4c6c-95a5-14761e7b2add", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "command-and-control"
                }, 
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "lateral-movement"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Remote File Copy", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "File monitoring", 
                "Packet capture", 
                "Process use of network", 
                "Netflow/Enclave netflow", 
                "Network protocol analysis", 
                "Process monitoring"
            ], 
            "x_mitre_network_requirements": true, 
            "x_mitre_permissions_required": [
                "User"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:47.843Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.\n\n===Windows===\n\nThere are multiple approaches to injecting code into a live process. Windows implementations include: (Citation: Engame Process Injection July 2017)\n* '''Dynamic-link library (DLL) injection''' involves writing the path to a malicious DLL inside a process then invoking execution by creating a remote thread.\n* '''Portable executable injection''' involves writing malicious code directly into the process (without a file on disk) then invoking execution with either additional code or by creating a remote thread. The displacement of the injected code introduces the additional requirement for functionality to remap memory references. Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue. (Citation: Endgame HuntingNMemory June 2017)\n* '''Thread execution hijacking''' involves injecting malicious code or the path to a DLL into a thread of a process. Similar to Process Hollowing, the thread must first be suspended.\n* '''Asynchronous Procedure Call''' (APC) injection involves attaching malicious code to the APC Queue (Citation: Microsoft APC) of a process's thread. Queued APC functions are executed when the thread enters an alterable state. AtomBombing  (Citation: ENSIL AtomBombing Oct 2016) is a variation that utilizes APCs to invoke malicious code previously written to the global atom table. (Citation: Microsoft Atom Table)\n* '''Thread Local Storage''' (TLS) callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. (Citation: FireEye TLS Nov 2017)\n\n===Mac and Linux===\n\nImplementations for Linux and OS X/macOS systems include: (Citation: Datawire Code Injection) (Citation: Uninformed Needle)\n*'''LD_PRELOAD, LD_LIBRARY_PATH''' (Linux), '''DYLD_INSERT_LIBRARIES''' (Mac OS X) environment variables, or the dlfcn application programming interface (API) can be used to dynamically load a library (shared object) in a process which can be used to intercept API calls from the running process. (Citation: Phrack halfdead 1997)\n*'''Ptrace system calls''' can be used to attach to a running process and modify it in runtime. (Citation: Uninformed Needle)\n*'''/proc/[pid]/mem''' provides access to the memory of the process and can be used to read/write arbitrary data to it. This technique is very rare due to its complexity. (Citation: Uninformed Needle)\n*'''VDSO hijacking''' performs runtime injection on ELF binaries by manipulating code stubs mapped in from the linux-vdso.so shared object. (Citation: VDSO hijack 2009)\n\nMalware commonly utilizes process injection to access system resources through which Persistence and other environment modifications can be made. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.\n\nDetection: Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC, and those that can be used to modify memory within another process, such as WriteProcessMemory, may be used for this technique. (Citation: Engame Process Injection July 2017)\n\nMonitoring for Linux specific calls such as the ptrace system call, the use of LD_PRELOAD environment variable, or dlfcn dynamic linking API calls, should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods.  (Citation: ArtOfMemoryForensics)  (Citation: GNU Acct)  (Citation: RHEL auditd)  (Citation: Chokepoint preload rootkits)\n\nMonitor for named pipe creation and connection events (Event IDs 17 and 18) for possible indicators of infected processes with external modules. (Citation: Microsoft Sysmon v6 May 2017)\n\nMonitor processes and command-line arguments for actions that could be done before or after code injection has occurred and correlate the information with related event information. Code injection may also be performed using PowerShell with tools such as PowerSploit, (Citation: Powersploit) so additional PowerShell monitoring may be required to cover known implementations of this behavior.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: API monitoring, Windows Registry, File monitoring, DLL monitoring, Named Pipes, Process Monitoring\n\nEffective Permissions: User, Administrator, SYSTEM, root\n\nDefense Bypassed: Process whitelisting, Anti-virus\n\nPermissions Required: User, Administrator, SYSTEM, root\n\nContributors: Anastasios Pingios", 
            "external_references": [
                {
                    "external_id": "T1055", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1055"
                }, 
                {
                    "description": "PowerSploit. (n.d.).  Retrieved December 4, 2014.", 
                    "source_name": "Powersploit", 
                    "url": "https://github.com/mattifestation/PowerSploit"
                }, 
                {
                    "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.", 
                    "source_name": "Engame Process Injection July 2017", 
                    "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
                }, 
                {
                    "description": "Desimone, J. (2017, June 13). Hunting in Memory. Retrieved December 7, 2017.", 
                    "source_name": "Endgame HuntingNMemory June 2017", 
                    "url": "https://www.endgame.com/blog/technical-blog/hunting-memory"
                }, 
                {
                    "description": "Microsoft. (n.d.). Asynchronous Procedure Calls. Retrieved December 8, 2017.", 
                    "source_name": "Microsoft APC", 
                    "url": "https://msdn.microsoft.com/library/windows/desktop/ms681951.aspx"
                }, 
                {
                    "description": "Liberman, T. (2016, October 27). ATOMBOMBING: BRAND NEW CODE INJECTION FOR WINDOWS. Retrieved December 8, 2017.", 
                    "source_name": "ENSIL AtomBombing Oct 2016", 
                    "url": "https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows"
                }, 
                {
                    "description": "Microsoft. (n.d.). About Atom Tables. Retrieved December 8, 2017.", 
                    "source_name": "Microsoft Atom Table", 
                    "url": "https://msdn.microsoft.com/library/windows/desktop/ms649053.aspx"
                }, 
                {
                    "description": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved December 18, 2017.", 
                    "source_name": "FireEye TLS Nov 2017", 
                    "url": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html"
                }, 
                {
                    "description": "Turner-Trauring, I. (2017, April 18). \u201cThis will only hurt for a moment\u201d: code injection on Linux and macOS with LD_PRELOAD. Retrieved December 20, 2017.", 
                    "source_name": "Datawire Code Injection", 
                    "url": "https://www.datawire.io/code-injection-on-linux-and-macos/"
                }, 
                {
                    "description": "skape. (2003, January 19). Linux x86 run-time process manipulation. Retrieved December 20, 2017.", 
                    "source_name": "Uninformed Needle", 
                    "url": "http://hick.org/code/skape/papers/needle.txt"
                }, 
                {
                    "description": "halflife. (1997, September 1). Shared Library Redirection Techniques. Retrieved December 20, 2017.", 
                    "source_name": "Phrack halfdead 1997", 
                    "url": "http://phrack.org/issues/51/8.html"
                }, 
                {
                    "description": "O'Neill, R. (2009, May). Modern Day ELF Runtime infection via GOT poisoning. Retrieved December 20, 2017.", 
                    "source_name": "VDSO hijack 2009", 
                    "url": "http://vxer.org/lib/vrn00.html"
                }, 
                {
                    "description": "Ligh, M.H. et al.. (2014, July). The Art of Memory Forensics: Detecting Malware and Threats in Windows, Linux, and Mac Memory. Retrieved December 20, 2017.", 
                    "source_name": "ArtOfMemoryForensics"
                }, 
                {
                    "description": "GNU. (2010, February 5). The GNU Accounting Utilities. Retrieved December 20, 2017.", 
                    "source_name": "GNU Acct", 
                    "url": "https://www.gnu.org/software/acct/"
                }, 
                {
                    "description": "Jahoda, M. et al.. (2017, March 14). redhat Security Guide - Chapter 7 - System Auditing. Retrieved December 20, 2017.", 
                    "source_name": "RHEL auditd", 
                    "url": "https://access.redhat.com/documentation/red%20hat%20enterprise%20linux/6/html/security%20guide/chap-system%20auditing"
                }, 
                {
                    "description": "stderr. (2014, February 14). Detecting Userland Preload Rootkits. Retrieved December 20, 2017.", 
                    "source_name": "Chokepoint preload rootkits", 
                    "url": "http://www.chokepoint.net/2014/02/detecting-userland-preload-rootkits.html"
                }, 
                {
                    "description": "Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved December 13, 2017.", 
                    "source_name": "Microsoft Sysmon v6 May 2017", 
                    "url": "https://docs.microsoft.com/sysinternals/downloads/sysmon"
                }
            ], 
            "id": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }, 
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "privilege-escalation"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Process Injection", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "Anastasios Pingios"
            ], 
            "x_mitre_data_sources": [
                "API monitoring", 
                "Windows Registry", 
                "File monitoring", 
                "DLL monitoring", 
                "Named Pipes", 
                "Process Monitoring"
            ], 
            "x_mitre_defense_bypassed": [
                "Process whitelisting", 
                "Anti-virus"
            ], 
            "x_mitre_effective_permissions": [
                "User", 
                "Administrator", 
                "SYSTEM", 
                "root"
            ], 
            "x_mitre_permissions_required": [
                "User", 
                "Administrator", 
                "SYSTEM", 
                "root"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:26.496Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Rootkits are programs that hide the existence of malware by intercepting (i.e., Hooking) and modifying operating system API calls that supply system information. (Citation: Symantec Windows Rootkits) Rootkits or rootkit enabling functionality may reside at the user or kernel level in the operating system or lower, to include a Hypervisor, Master Boot Record, or the System Firmware. (Citation: Wikipedia Rootkit)\n\nAdversaries may use rootkits to hide the presence of programs, files, network connections, services, drivers, and other system components. Rootkits have been seen for Windows, Linux, and Mac OS X systems. (Citation: CrowdStrike Linux Rootkit) (Citation: BlackHat Mac OSX Rootkit)\n\nDetection: Some rootkit protections may be built into anti-virus or operating system software. There are dedicated rootkit detection tools that look for specific types of rootkit behavior. Monitor for the existence of unrecognized DLLs, devices, services, and changes to the MBR. (Citation: Wikipedia Rootkit)\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: BIOS, MBR, System calls\n\nDefense Bypassed: Anti-virus, File monitoring, Host intrusion prevention systems, Process whitelisting, Signature-based detection, System access controls, Whitelisting by file name or path\n\nPermissions Required: Administrator, SYSTEM, root", 
            "external_references": [
                {
                    "external_id": "T1014", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1014"
                }, 
                {
                    "description": "Wikipedia. (2016, June 1). Rootkit. Retrieved June 2, 2016.", 
                    "source_name": "Wikipedia Rootkit", 
                    "url": "https://en.wikipedia.org/wiki/Rootkit"
                }, 
                {
                    "description": "Symantec. (n.d.). Windows Rootkit Overview. Retrieved December 21, 2017.", 
                    "source_name": "Symantec Windows Rootkits", 
                    "url": "https://www.symantec.com/avcenter/reference/windows.rootkit.overview.pdf"
                }, 
                {
                    "description": "Kurtz, G. (2012, November 19). HTTP iframe Injecting Linux Rootkit. Retrieved December 21, 2017.", 
                    "source_name": "CrowdStrike Linux Rootkit", 
                    "url": "https://www.crowdstrike.com/blog/http-iframe-injecting-linux-rootkit/"
                }, 
                {
                    "description": "Pan, M., Tsai, S. (2014). You can\u2019t see me: A Mac OS X Rootkit uses the tricks you haven't known yet. Retrieved December 21, 2017.", 
                    "source_name": "BlackHat Mac OSX Rootkit", 
                    "url": "http://www.blackhat.com/docs/asia-14/materials/Tsai/WP-Asia-14-Tsai-You-Cant-See-Me-A-Mac-OS-X-Rootkit-Uses-The-Tricks-You-Havent-Known-Yet.pdf"
                }
            ], 
            "id": "attack-pattern--0f20e3cb-245b-4a61-8a91-2d93f7cb0e9b", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Rootkit", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "BIOS", 
                "MBR", 
                "System calls"
            ], 
            "x_mitre_defense_bypassed": [
                "Anti-virus", 
                "File monitoring", 
                "Host intrusion prevention systems", 
                "Process whitelisting", 
                "Signature-based detection", 
                "System access controls", 
                "Whitelisting by file name or path"
            ], 
            "x_mitre_permissions_required": [
                "Administrator", 
                "SYSTEM", 
                "root"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:45.613Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "When operating systems boot up, they can start programs or applications called services that perform background system functions. (Citation: TechNet Services) A service's configuration information, including the file path to the service's executable, is stored in the Windows Registry. \n\nAdversaries may install a new service that can be configured to execute at startup by using utilities to interact with services or by directly modifying the Registry. The service name may be disguised by using a name from a related operating system or benign software with Masquerading. Services may be created with administrator privileges but are executed under SYSTEM privileges, so an adversary may also use a service to escalate privileges from administrator to SYSTEM. Adversaries may also directly start services through Service Execution.\n\nDetection: Monitor service creation through changes in the Registry and common utilities using command-line invocation. New, benign services may be created during installation of new software. Data and events should not be viewed in isolation, but as part of a chain of behavior that could lead to other activities, such as network connections made for Command and Control, learning details about the environment through Discovery, and Lateral Movement.\n\nTools such as Sysinternals Autoruns may also be used to detect system changes that could be attempts at persistence. (Citation: TechNet Autoruns) Look for changes to services that do not correlate with known software, patch cycles, etc. Suspicious program execution through services may show up as outlier processes that have not been seen before when compared against historical data.\n\nMonitor processes and command-line arguments for actions that could create services. Remote access tools with built-in features may interact directly with the Windows API to perform these functions outside of typical system utilities. Services may also be created through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.\n\nPlatforms: Windows\n\nData Sources: Windows Registry, Process monitoring, Process command-line parameters\n\nEffective Permissions: SYSTEM\n\nPermissions Required: Administrator, SYSTEM", 
            "external_references": [
                {
                    "external_id": "T1050", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1050"
                }, 
                {
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.", 
                    "source_name": "TechNet Autoruns", 
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }, 
                {
                    "description": "Microsoft. (n.d.). Services. Retrieved June 7, 2016.", 
                    "source_name": "TechNet Services", 
                    "url": "https://technet.microsoft.com/en-us/library/cc772408.aspx"
                }
            ], 
            "id": "attack-pattern--478aa214-2ca7-4ec0-9978-18798e514790", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "persistence"
                }, 
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "privilege-escalation"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "New Service", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Windows Registry", 
                "Process monitoring", 
                "Process command-line parameters"
            ], 
            "x_mitre_effective_permissions": [
                "SYSTEM"
            ], 
            "x_mitre_permissions_required": [
                "Administrator", 
                "SYSTEM"
            ], 
            "x_mitre_platforms": [
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:53.408Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries may conduct C2 communications over a non-standard port to bypass proxies and firewalls that have been improperly configured.\n\nDetection: Analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect communications that do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: Netflow/Enclave netflow, Process use of network, Process monitoring\n\nRequires Network: Yes", 
            "external_references": [
                {
                    "external_id": "T1065", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1065"
                }, 
                {
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", 
                    "source_name": "University of Birmingham C2", 
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }
            ], 
            "id": "attack-pattern--c848fcf7-6b62-4bde-8216-b6c157d48da0", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "command-and-control"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Uncommonly Used Port", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Netflow/Enclave netflow", 
                "Process use of network", 
                "Process monitoring"
            ], 
            "x_mitre_network_requirements": true, 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:48.323Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries can use methods of capturing user input for obtaining credentials for Valid Accounts and information Collection that include keylogging and user input field interception.\n\nKeylogging is the most prevalent type of input capture, with many different ways of intercepting keystrokes, (Citation: Adventures of a Keystroke) but other methods exist to target information for specific purposes, such as performing a UAC prompt or wrapping the Windows default credential provider. (Citation: Wrightson 2012)\n\nKeylogging is likely to be used to acquire credentials for new access opportunities when Credential Dumping efforts are not effective, and may require an adversary to remain passive on a system for a period of time before an opportunity arises.\n\nAdversaries may also install code on externally facing portals, such as a VPN login page, to capture and transmit credentials of users who attempt to log into the service. This variation on input capture may be conducted post-compromise using legitimate administrative access as a backup measure to maintain network access through External Remote Services and Valid Accounts or as part of the initial compromise by exploitation of the externally facing web service. (Citation: Volexity Virtual Private Keylogging)\n\nDetection: Keyloggers may take many forms, possibly involving modification to the Registry and installation of a driver, setting a hook, or polling to intercept keystrokes. Commonly used API calls include SetWindowsHook, GetKeyState, and GetAsynceyState. (Citation: Adventures of a Keystroke) Monitor the Registry and file system for such changes and detect driver installs, as well as looking for common keylogging API calls. API calls alone are not an indicator of keylogging, but may provide behavioral data that is useful when combined with other information such as new files written to disk and unusual processes.\n\nMonitor the Registry for the addition of a Custom Credential Provider. (Citation: Wrightson 2012) Detection of compromised Valid Accounts in use by adversaries may help to catch the result of user input interception if new techniques are used.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: Windows Registry, Kernel drivers, Process monitoring, API monitoring\n\nPermissions Required: Administrator, SYSTEM\n\nContributors: John Lambert, Microsoft Threat Intelligence Center", 
            "external_references": [
                {
                    "external_id": "T1056", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1056"
                }, 
                {
                    "description": "Tinaztepe,  E. (n.d.). The Adventures of a Keystroke:  An in-depth look into keyloggers on Windows. Retrieved April 27, 2016.", 
                    "source_name": "Adventures of a Keystroke"
                }, 
                {
                    "description": "Wrightson, T. (2012, January 2). CAPTURING WINDOWS 7 CREDENTIALS AT LOGON USING CUSTOM CREDENTIAL PROVIDER. Retrieved November 12, 2014.", 
                    "source_name": "Wrightson 2012", 
                    "url": "http://blog.leetsys.com/2012/01/02/capturing-windows-7-credentials-at-logon-using-custom-credential-provider/"
                }, 
                {
                    "description": "Adair, S. (2015, October 7). Virtual Private Keylogging: Cisco Web VPNs Leveraged for Access and Persistence. Retrieved March 20, 2017.", 
                    "source_name": "Volexity Virtual Private Keylogging", 
                    "url": "https://www.volexity.com/blog/2015/10/07/virtual-private-keylogging-cisco-web-vpns-leveraged-for-access-and-persistence/"
                }
            ], 
            "id": "attack-pattern--bb5a00de-e086-4859-a231-fa793f6797e2", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "collection"
                }, 
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "credential-access"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Input Capture", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "John Lambert, Microsoft Threat Intelligence Center"
            ], 
            "x_mitre_data_sources": [
                "Windows Registry", 
                "Kernel drivers", 
                "Process monitoring", 
                "API monitoring"
            ], 
            "x_mitre_permissions_required": [
                "Administrator", 
                "SYSTEM"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:20.537Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Sensitive data can be collected from local system sources, such as the file system or databases of information residing on the system prior to Exfiltration.\n\nAdversaries will often search the file system on computers they have compromised to find files of interest. They may do this using a Command-Line Interface, such as cmd, which has functionality to interact with the file system to gather information. Some adversaries may also use Automated Collection on the local system.\n\nDetection: Monitor processes and command-line arguments for actions that could be taken to collect files from a system. Remote access tools with built-in features may interact directly with the Windows API to gather data. Data may also be acquired through Windows system management tools such as Windows Management Instrumentation and PowerShell.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: File monitoring, Process monitoring, Process command-line parameters\n\nSystem Requirements: Privileges to access certain files and directories", 
            "external_references": [
                {
                    "external_id": "T1005", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1005"
                }
            ], 
            "id": "attack-pattern--3c4a2599-71ee-4405-ba1e-0e28414b4bc5", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "collection"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Data from Local System", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "File monitoring", 
                "Process monitoring", 
                "Process command-line parameters"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ], 
            "x_mitre_system_requirements": [
                "Privileges to access certain files and directories"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:34.928Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Windows service configuration information, including the file path to the service's executable or recovery programs/commands, is stored in the Registry. Service configurations can be modified using utilities such as sc.exe and Reg.\n\nAdversaries can modify an existing service to persist malware on a system by using system utilities or by using custom tools to interact with the Windows API. Use of existing services is a type of Masquerading that may make detection analysis more challenging. Modifying existing services may interrupt their functionality or may enable services that are disabled or otherwise not commonly used.\n\nAdversaries may also intentionally corrupt or kill services to execute malicious recovery programs/commands. (Citation: Twitter Service Recovery Nov 2017) (Citation: Microsoft Service Recovery Feb 2013)\n\nDetection: Look for changes to service Registry entries that do not correlate with known software, patch cycles, etc. Changes to the binary path and the service startup type changed from manual or disabled to automatic, if it does not typically do so, may be suspicious. Tools such as Sysinternals Autoruns may also be used to detect system service changes that could be attempts at persistence. (Citation: TechNet Autoruns) \n\nService information is stored in the Registry at <code>HKLM\\SYSTEM\\CurrentControlSet\\Services</code>.\n\nCommand-line invocation of tools capable of modifying services may be unusual, depending on how systems are typically used in a particular environment. Collect service utility execution and service binary path arguments used for analysis. Service binary paths may even be changed to execute cmd commands or scripts.\n\nLook for abnormal process call trees from known services and for execution of other commands that could relate to Discovery or other adversary techniques. Services may also be modified through Windows system management tools such as Windows Management Instrumentation and PowerShell, so additional logging may need to be configured to gather the appropriate data.\n\nPlatforms: Windows\n\nData Sources: Windows Registry, File monitoring, Process command-line parameters, Process monitoring\n\nPermissions Required: Administrator, SYSTEM\n\nContributors: Travis Smith, Tripwire, Matthew Demaske, Adaptforward", 
            "external_references": [
                {
                    "external_id": "T1031", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1031"
                }, 
                {
                    "description": "Russinovich, M. (2016, January 4). Autoruns for Windows v13.51. Retrieved June 6, 2016.", 
                    "source_name": "TechNet Autoruns", 
                    "url": "https://technet.microsoft.com/en-us/sysinternals/bb963902"
                }, 
                {
                    "description": "The Cyber (@r0wdy_). (2017, November 30). Service Recovery Parameters. Retrieved April 9, 2018.", 
                    "source_name": "Twitter Service Recovery Nov 2017", 
                    "url": "https://twitter.com/r0wdy%20/status/936365549553991680"
                }, 
                {
                    "description": "Microsoft. (2013, February 22). Set up Recovery Actions to Take Place When a Service Fails. Retrieved April 9, 2018.", 
                    "source_name": "Microsoft Service Recovery Feb 2013", 
                    "url": "https://docs.microsoft.com/previous-versions/windows/it-pro/windows-server-2008-R2-and-2008/cc753662(v=ws.11)"
                }
            ], 
            "id": "attack-pattern--62dfd1ca-52d5-483c-a84b-d6e80bf94b7b", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "persistence"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Modify Existing Service", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "Travis Smith, Tripwire", 
                "Matthew Demaske, Adaptforward"
            ], 
            "x_mitre_data_sources": [
                "Windows Registry", 
                "File monitoring", 
                "Process command-line parameters", 
                "Process monitoring"
            ], 
            "x_mitre_permissions_required": [
                "Administrator", 
                "SYSTEM"
            ], 
            "x_mitre_platforms": [
                "Windows"
            ]
        }
    ], 
    "hash": "923dd2f1c8e10d193163c67e66240dfeaaefd8d915d8adae292be4f19c40f873", 
    "name": "Darkmoon"
}