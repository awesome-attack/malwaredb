{
    "alias": "Dofoil", 
    "analysis": {
        "_id": {
            "$oid": "5ba559faba80ffe26b515b41"
        }, 
        "description": "PE32 executable (GUI) Intel 80386, for MS Windows, PECompact2 compressed", 
        "file_id": "2f067028ec329b0f59193e87e29267665ad3f465", 
        "fuzzy_hash": "1536:IsINnKzZEAF4I3IPKzaBoJkIwiJjWgs+rKSNI:IsIcl34IEjBo24xWC", 
        "hash": {
            "md5": "23a5df29b6fbd5b7eabff720fc4d6310", 
            "sha1": "2f067028ec329b0f59193e87e29267665ad3f465", 
            "sha2": "5caab10fbeb74c7d5b8765b0cc32a451ddfc80dc9d2b2ae8408a65494efdc060"
        }, 
        "mime_type": "application/x-dosexec", 
        "particular_header": {
            "av_analysis": "Not_implemented", 
            "certificate": {}, 
            "child_of": "Not_implemented", 
            "cypher": "Not_implemented", 
            "date": "'0x5266F38C [SUSPICIOUS]'", 
            "ep": "'0x402558 .text 0/2'", 
            "exports": {}, 
            "file_entropy": 7.049311209788583, 
            "headers": {
                "dos_header": {
                    "cblp": "'0x90'", 
                    "cp": "'0x3'", 
                    "cparhdr": "'0x4'", 
                    "crlc": "'0x0'", 
                    "cs": "'0x0'", 
                    "csum": "'0x0'", 
                    "ip": "'0x0'", 
                    "lfanew": "'0xf8'", 
                    "lfarlc": "'0x40'", 
                    "magic": "'0x5a4d'", 
                    "maxalloc": "'0xffff'", 
                    "minalloc": "'0x0'", 
                    "oemid": "'0x0'", 
                    "oeminfo": "'0x0'", 
                    "ovno": "'0x0'", 
                    "res": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "res2": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "sp": "'0xb8'", 
                    "ss": "'0x0'"
                }, 
                "file_header": {
                    "Characteristics": "'0x103'", 
                    "Machine": "'0x14c'", 
                    "NumberOfSections": "'0x2'", 
                    "NumberOfSymbols": "'0x0'", 
                    "PointerToSymbolTable": "'0x0'", 
                    "SizeOfOptionalHeader": "'0xe0'", 
                    "TimeDateStamp": "'0x5266f38c'"
                }, 
                "nt_header": {
                    "Signature": "'0x4550'"
                }, 
                "optional_header": {
                    "AddressOfEntryPoint": "'0x2558'", 
                    "BaseOfCode": "'0x1000'", 
                    "CheckSum": "'0x11fee'", 
                    "DllCharacteristics": "'0x8100'", 
                    "FileAlignment": "'0x200'", 
                    "ImageBase": "'0x400000'", 
                    "LoaderFlags": "'0x0'", 
                    "Magic": "'0x10b'", 
                    "MajorImageVersion": "'0x0'", 
                    "MajorLinkerVersion": "'0x9'", 
                    "MajorOperatingSystemVersion": "'0x5'", 
                    "MajorSubsystemVersion": "'0x5'", 
                    "MinorImageVersion": "'0x0'", 
                    "MinorLinkerVersion": "'0x0'", 
                    "MinorOperatingSystemVersion": "'0x0'", 
                    "MinorSubsystemVersion": "'0x0'", 
                    "NumberOfRvaAndSizes": "'0x10'", 
                    "Reserved1": "'0x0'", 
                    "SectionAlignment": "'0x1000'", 
                    "SizeOfCode": "'0x1800'", 
                    "SizeOfHeaders": "'0x400'", 
                    "SizeOfHeapCommit": "'0x1000'", 
                    "SizeOfHeapReserve": "'0x100000'", 
                    "SizeOfImage": "'0x1a000'", 
                    "SizeOfInitializedData": "'0x12200'", 
                    "SizeOfStackCommit": "'0x1000'", 
                    "SizeOfStackReserve": "'0x100000'", 
                    "SizeOfUninitializedData": "'0x0'", 
                    "Subsystem": "'0x2'"
                }
            }, 
            "imports": [
                {
                    "functions": [
                        "'loadlibrarya'", 
                        "'getprocaddress'", 
                        "'virtualalloc'", 
                        "'virtualfree'"
                    ], 
                    "lib": "'kernel32.dll'"
                }
            ], 
            "imports_tree": "added", 
            "packer_detection": "Unknown", 
            "packer_version": "Not_implemented", 
            "res_entries": [
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x16100'", 
                    "sha1": "3ea85f7d4e2f50e80c9ffcd47c02efaa2440533a", 
                    "size": "'0x1ca8'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'data'"
                }, 
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x17da8'", 
                    "sha1": "303f0e4bf2c58f82bf91619285571fd343f1ce97", 
                    "size": "'0xca8'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'dBase III DBT, version number 0, next free block index 40'"
                }, 
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x18a50'", 
                    "sha1": "2f9a85bfcf163ba9f3117176d7be5eea055009c3", 
                    "size": "'0x368'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'GLS_BINARY_LSB_FIRST'"
                }, 
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_GROUP_ICON'", 
                    "rva": "'0x18db8'", 
                    "sha1": "0c41bb05323522532535e5ae4bb95638d42e37ac", 
                    "size": "'0x30'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'MS Windows icon resource - 3 icons, 48x48'"
                }
            ], 
            "sections": [
                {
                    "characteristics": "0xe0000020", 
                    "entropy": 7.561352564227274, 
                    "fuzzy_hash": "768:5sHypvVn711KzZJ6l89BfWNxHzD6B3CrPvizNlJtm+ZQ8VJkIpfiYU4JjWg:5sINnKzZEAF4I3IPKzaBoJkIwiJjWg", 
                    "md5": "ccdecccab3d38c7596f8e0cc628f7e13", 
                    "name": "'.text\\x00\\x00\\x00'", 
                    "sha1": "db1a3a39876b940f6eed38c868783400d7121d4f", 
                    "sha2": "a4f4ac9266d2ebeb8927b8f603f6cc2bb106bf890ef1a79e48e069277c09ec10", 
                    "size_raw_data": 46080, 
                    "virtual_size": 86016, 
                    "write_executable": "True"
                }, 
                {
                    "characteristics": "0xe0000020", 
                    "entropy": 4.990719822986992, 
                    "fuzzy_hash": "192:cn2ZvNWjGs+WZxRujfVbkdRl86bHtD6n4sM2:cn2XWjDZx3KSND6n4s", 
                    "md5": "4373c7aac77d18b24d73d194ac96b140", 
                    "name": "'.rsrc\\x00\\x00\\x00'", 
                    "sha1": "3ffffa59ff653e6f8106aefa1e08fb94a1b31cd0", 
                    "sha2": "2da7267cc95d739f874eeb2bebc6b86f63f44369c82dd2770bc995b7fc3ad7b0", 
                    "size_raw_data": 16384, 
                    "virtual_size": 16384, 
                    "write_executable": "True"
                }
            ], 
            "strings": {
                "hidden_dll": [
                    "'kernel32'", 
                    "'user32'"
                ], 
                "hidden_imports": [
                    "'messageboxa'", 
                    "'virtualprotect'"
                ], 
                "raw_strings": [
                    "' $oc '", 
                    "' kwwa'", 
                    "' u(h'", 
                    "'$eao='", 
                    "'$khh'", 
                    "'$sgj=lu'", 
                    "'%mwz'", 
                    "'%nux'", 
                    "'&?v d'", 
                    "'&]wn'", 
                    "'&h?('", 
                    "'(07t'", 
                    "')ih-'", 
                    "',m.v'", 
                    "',m<</)hz'", 
                    "',sjal'", 
                    "'-7ny'", 
                    "'-hfk'", 
                    "'-kcwf.d'", 
                    "'-uhv'", 
                    "'-yf0'", 
                    "'.,b:'", 
                    "'.lxd'", 
                    "'/=z)'", 
                    "'/khj'", 
                    "'0%saw'", 
                    "'07z2'", 
                    "'0yv '", 
                    "'15qr'", 
                    "'1mke.'", 
                    "'1n)m'", 
                    "'1sn2h'", 
                    "'2&_&'", 
                    "'2.h,i'", 
                    "'2aqb'", 
                    "'2ds72'", 
                    "'2ecvr'", 
                    "'2l)(/'", 
                    "'3)k/'", 
                    "'37ej'", 
                    "'448)'", 
                    "'4koc'", 
                    "'4xq6'", 
                    "'4y-q'", 
                    "'65for'", 
                    "'6@gq42u'", 
                    "'6wt]x4l'", 
                    "'7<p$8s'", 
                    "'7a4j'", 
                    "'7b1$('", 
                    "'7d2lw)'", 
                    "'7e?v'", 
                    "'7ljr'", 
                    "'8(f5'", 
                    "'8gyv'", 
                    "'9k5['", 
                    "'9mu?'", 
                    "'9soi'", 
                    "':9xh'", 
                    "':klp'", 
                    "'<=4b'", 
                    "'<me9'", 
                    "'<x[k'", 
                    "'=[v4'", 
                    "'=p1,u'", 
                    "'=rc7d'", 
                    "'?8./xg'", 
                    "'?ijzh'", 
                    "'@=y4'", 
                    "'@[i:'", 
                    "'@a$b'", 
                    "'@e_etst'", 
                    "'@tt3'", 
                    "'[:r '", 
                    "'[c_['", 
                    "'[eds'", 
                    "'[m$mv/'", 
                    "'[xk<'", 
                    "']1kc'", 
                    "']6q-'", 
                    "']eyuv'", 
                    "']x4y&'", 
                    "']zxs'", 
                    "'_ r9n'", 
                    "'_]ae'", 
                    "'_lq='", 
                    "'_y[]'", 
                    "'aarq'", 
                    "'abbd'", 
                    "'abd<'", 
                    "'ac$:'", 
                    "'afj_9'", 
                    "'aj&s ]'", 
                    "'ak&zv'", 
                    "'andle'", 
                    "'appl'", 
                    "'arxx'", 
                    "'b1po'", 
                    "'b@w@'", 
                    "'ba-a'", 
                    "'bgni'", 
                    "'bh?z'", 
                    "'bl2l'", 
                    "'btuq'", 
                    "'c>4g'", 
                    "'cated in the dll %s4ordinaj'", 
                    "'cek]m'", 
                    "'closehx'", 
                    "'cmde'", 
                    "'corrupt.'", 
                    "'cs?q'", 
                    "'csw('", 
                    "'d)]2'", 
                    "'d._g'", 
                    "'d5ik'", 
                    "'dr1q'", 
                    "'dw0v?'", 
                    "'dwyi'", 
                    "'eef.'", 
                    "'eod3'", 
                    "'ep<]'", 
                    "'etwc'", 
                    "'ew=='", 
                    "'exitp'", 
                    "'eyzi'", 
                    "'f uu7'", 
                    "'f9my'", 
                    "'f< x'", 
                    "'fhshf9'", 
                    "'fphg'", 
                    "'frrs'", 
                    "'fzk '", 
                    "'g?/s'", 
                    "'g@gk'", 
                    "'g_5f'", 
                    "'gcmw['", 
                    "'ge2a2f'", 
                    "'getmodul'", 
                    "'grorq'", 
                    "'gu2%'", 
                    "'guaa'", 
                    "'h=x]'", 
                    "'hc4f'", 
                    "'hcz_'", 
                    "'hhaa'", 
                    "'ht:4x'", 
                    "'iaf6'", 
                    "'ication error'", 
                    "'idkajm'", 
                    "'ijv4'", 
                    "'iqno'", 
                    "'irxk'", 
                    "'iyzf'", 
                    "'j.?,7a'", 
                    "'j1bx'", 
                    "'jcz/'", 
                    "'jk-o0wz'", 
                    "'k_,em'", 
                    "'kald'", 
                    "'keoq'", 
                    "'kernel32'", 
                    "'km<g'", 
                    "'kptk'", 
                    "'kpzdo'", 
                    "'kt0.'", 
                    "'l %d2'", 
                    "'l$df'", 
                    "'l8o.'", 
                    "'ldynn'", 
                    "'m$lh='", 
                    "'m],md'", 
                    "'messageboxa'", 
                    "'mnu]'", 
                    "'mrjctv'", 
                    "'msvbv'", 
                    "'mxcd'", 
                    "'n@=e'", 
                    "'nx85'", 
                    "'nz9x?d($'", 
                    "'o6up'", 
                    "'olab'", 
                    "'open'", 
                    "'ow[n['", 
                    "'p4$?'", 
                    "'p?7d'", 
                    "'paen'", 
                    "'pecompact2'", 
                    "'pemmu'", 
                    "'pju9'", 
                    "'ps)nv'", 
                    "'pvm-'", 
                    "'pwqs'", 
                    "'q):('", 
                    "'q,kq6'", 
                    "'q1s:'", 
                    "'q@@h'", 
                    "'q]r:f'", 
                    "'qm8i'", 
                    "'r(dj'", 
                    "'rein'", 
                    "'rfbc'", 
                    "'rzcl'", 
                    "'rzor'", 
                    "'s4[g'", 
                    "'s@o0'", 
                    "'sqyd'", 
                    "'sw0f'", 
                    "'swvu'", 
                    "'sww]q'", 
                    "'sy0v'", 
                    "'t]av'", 
                    "'tbuj/54a$k60'", 
                    "'tcbw'", 
                    "'tf[qq'", 
                    "'the procedure %s could not be lo'", 
                    "'tn5oq'", 
                    "'u1 td'", 
                    "'urd0p'", 
                    "'user32'", 
                    "'usqwvr'", 
                    "'vfmt'", 
                    "'vibi?'", 
                    "'virtualprotect'", 
                    "'vso -'", 
                    "'vtgi('", 
                    "'vvo2'", 
                    "'vxgl '", 
                    "'w)tf'", 
                    "'w=tb'", 
                    "'w>43.'", 
                    "'w])o'", 
                    "'wm86'", 
                    "'wsprin'", 
                    "'x)<z'", 
                    "'xvbu'", 
                    "'xwn2'", 
                    "'y/j%b'", 
                    "'y6kh'", 
                    "'ycu3'", 
                    "'ydo6'", 
                    "'ye5dw'", 
                    "'yhf-'", 
                    "'ymw_'", 
                    "'ytex'", 
                    "'ytmq'", 
                    "'yv@xu'", 
                    "'z5p['", 
                    "'z:)h'", 
                    "'z[gr'", 
                    "'zhga['", 
                    "'zi:oi'", 
                    "'zo_cr'", 
                    "'zt@d'", 
                    "'zyytu'"
                ]
            }, 
            "version": {}
        }, 
        "size": 63488
    }, 
    "attack-pattern": [
        {
            "created": "2017-05-31T21:31:09.815Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Process hollowing occurs when a process is created in a suspended state then its memory is unmapped and replaced with malicious code. Similar to Process Injection, execution of the malicious code is masked under a legitimate process and may evade defenses and detection analysis. (Citation: Leitch Hollowing) (Citation: Engame Process Injection July 2017)\n\nDetection: Monitoring API calls may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. API calls that unmap process memory, such as ZwUnmapViewOfSection or NtUnmapViewOfSection, and those that can be used to modify memory within another process, such as WriteProcessMemory, may be used for this technique. (Citation: Engame Process Injection July 2017)\n\nAnalyze process behavior to determine if a process is performing actions it usually does not, such as opening network connections, reading files, or other suspicious actions that could relate to post-compromise behavior.\n\nPlatforms: Windows\n\nData Sources: Process monitoring, API monitoring\n\nDefense Bypassed: Process whitelisting, Anti-virus, Whitelisting by file name or path, Signature-based detection\n\nPermissions Required: User", 
            "external_references": [
                {
                    "external_id": "T1093", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1093"
                }, 
                {
                    "description": "Leitch, J. (n.d.). Process Hollowing. Retrieved November 12, 2014.", 
                    "source_name": "Leitch Hollowing", 
                    "url": "http://www.autosectools.com/process-hollowing.pdf"
                }, 
                {
                    "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.", 
                    "source_name": "Engame Process Injection July 2017", 
                    "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
                }
            ], 
            "id": "attack-pattern--1c338d0f-a65e-4073-a5c1-c06878849f21", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Process Hollowing", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Process monitoring", 
                "API monitoring"
            ], 
            "x_mitre_defense_bypassed": [
                "Process whitelisting", 
                "Anti-virus", 
                "Whitelisting by file name or path", 
                "Signature-based detection"
            ], 
            "x_mitre_permissions_required": [
                "User"
            ], 
            "x_mitre_platforms": [
                "Windows"
            ]
        }, 
        {
            "created": "2018-04-18T17:59:24.739Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Supply chain compromise is the manipulation of products or product delivery mechanisms prior to receipt by a final consumer for the purpose of data or system compromise. Supply chain compromise can take place at any stage of the supply chain including:\n* Manipulation of development tools\n* Manipulation of a development environment\n* Manipulation of source code repositories (public or private)\n* Manipulation of software update/distribution mechanisms\n* Compromised/infected system images (multiple cases of removable media infected at the factory)\n* Replacement of legitimate software with modified versions\n* Sales of modified/counterfeit products to legitimate distributors\n* Shipment interdiction\n\nWhile supply chain compromise can impact any component of hardware or software, attackers looking to gain execution have often focused on malicious additions to legitimate software in software distribution or update channels. (Citation: Avast CCleaner3 2018) (Citation: Microsoft Dofoil 2018) (Citation: Command Five SK 2011) Targeting may be specific to a desired victim set (Citation: Symantec Elderwood Sept 2012) or malicious software may be distributed to a broad set of consumers but only move on to additional tactics  on specific victims. (Citation: Avast CCleaner3 2018) (Citation: Command Five SK 2011)\n\nDetection: Use verification of distributed binaries through hash checking or other integrity checking mechanisms. Scan downloads for malicious signatures and attempt to test software and updates prior to deployment while taking note of potential suspicious activity. Perform physical inspection of hardware to look for potential tampering.\n\nPlatforms: Linux, Windows, macOS\n\nData Sources: Web proxy, File monitoring", 
            "external_references": [
                {
                    "external_id": "T1195", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1195"
                }, 
                {
                    "description": "Avast Threat Intelligence Team. (2018, March 8). New investigations into the CCleaner incident point to a possible third stage that had keylogger capacities. Retrieved March 15, 2018.", 
                    "source_name": "Avast CCleaner3 2018", 
                    "url": "https://blog.avast.com/new-investigations-in-ccleaner-incident-point-to-a-possible-third-stage-that-had-keylogger-capacities"
                }, 
                {
                    "description": "Windows Defender Research. (2018, March 7). Behavior monitoring combined with machine learning spoils a massive Dofoil coin mining campaign. Retrieved March 20, 2018.", 
                    "source_name": "Microsoft Dofoil 2018", 
                    "url": "https://cloudblogs.microsoft.com/microsoftsecure/2018/03/07/behavior-monitoring-combined-with-machine-learning-spoils-a-massive-dofoil-coin-mining-campaign/"
                }, 
                {
                    "description": "Command Five Pty Ltd. (2011, September). SK Hack by an Advanced Persistent Threat. Retrieved April 6, 2018.", 
                    "source_name": "Command Five SK 2011", 
                    "url": "https://www.commandfive.com/papers/C5%20APT%20SKHack.pdf"
                }, 
                {
                    "description": "O'Gorman, G., and McDonald, G.. (2012, September 6). The Elderwood Project. Retrieved February 15, 2018.", 
                    "source_name": "Symantec Elderwood Sept 2012", 
                    "url": "http://www.symantec.com/content/en/us/enterprise/media/security%20response/whitepapers/the-elderwood-project.pdf"
                }
            ], 
            "id": "attack-pattern--3f18edba-28f4-4bb9-82c3-8aa60dcac5f7", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "initial-access"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Supply Chain Compromise", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Web proxy", 
                "File monitoring"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "Windows", 
                "macOS"
            ]
        }
    ], 
    "hash": "5caab10fbeb74c7d5b8765b0cc32a451ddfc80dc9d2b2ae8408a65494efdc060", 
    "name": "Smoke Loader"
}