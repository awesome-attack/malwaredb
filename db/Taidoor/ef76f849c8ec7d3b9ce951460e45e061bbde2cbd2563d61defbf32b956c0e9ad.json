{
    "alias": "Taidoor", 
    "analysis": {
        "_id": {
            "$oid": "5ba555a2ba80ffe26b5152d1"
        }, 
        "description": "PE32 executable (GUI) Intel 80386, for MS Windows", 
        "file_id": "c034738fff845280a85d0fa9bdd083ff749573fd", 
        "fuzzy_hash": "1536:mPWBLZrBpKdzMMHjmWFj7DB3aKd99J5ZVZDZZmUfu+/ZuYsS15:qW/rB0dnQijJ5ZVZDTT/MYsSz", 
        "hash": {
            "md5": "2a450da9ff5e0a28853fa738a275000d", 
            "sha1": "c034738fff845280a85d0fa9bdd083ff749573fd", 
            "sha2": "ef76f849c8ec7d3b9ce951460e45e061bbde2cbd2563d61defbf32b956c0e9ad"
        }, 
        "mime_type": "application/x-dosexec", 
        "particular_header": {
            "av_analysis": "Not_implemented", 
            "certificate": {}, 
            "child_of": "Not_implemented", 
            "cypher": "Not_implemented", 
            "date": "'0x4D6605EF [SUSPICIOUS]'", 
            "ep": "'0x402281 .text 0/4'", 
            "exports": {}, 
            "file_entropy": 5.961806816220317, 
            "headers": {
                "dos_header": {
                    "cblp": "'0x90'", 
                    "cp": "'0x3'", 
                    "cparhdr": "'0x4'", 
                    "crlc": "'0x0'", 
                    "cs": "'0x0'", 
                    "csum": "'0x0'", 
                    "ip": "'0x0'", 
                    "lfanew": "'0xe0'", 
                    "lfarlc": "'0x40'", 
                    "magic": "'0x5a4d'", 
                    "maxalloc": "'0xffff'", 
                    "minalloc": "'0x0'", 
                    "oemid": "'0x0'", 
                    "oeminfo": "'0x0'", 
                    "ovno": "'0x0'", 
                    "res": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "res2": "'\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00\\x00'", 
                    "sp": "'0xb8'", 
                    "ss": "'0x0'"
                }, 
                "file_header": {
                    "Characteristics": "'0x103'", 
                    "Machine": "'0x14c'", 
                    "NumberOfSections": "'0x4'", 
                    "NumberOfSymbols": "'0x0'", 
                    "PointerToSymbolTable": "'0x0'", 
                    "SizeOfOptionalHeader": "'0xe0'", 
                    "TimeDateStamp": "'0x4d6605ef'"
                }, 
                "nt_header": {
                    "Signature": "'0x4550'"
                }, 
                "optional_header": {
                    "AddressOfEntryPoint": "'0x2281'", 
                    "BaseOfCode": "'0x1000'", 
                    "CheckSum": "'0x13c6a'", 
                    "DllCharacteristics": "'0x8000'", 
                    "FileAlignment": "'0x200'", 
                    "ImageBase": "'0x400000'", 
                    "LoaderFlags": "'0x0'", 
                    "Magic": "'0x10b'", 
                    "MajorImageVersion": "'0x0'", 
                    "MajorLinkerVersion": "'0x9'", 
                    "MajorOperatingSystemVersion": "'0x5'", 
                    "MajorSubsystemVersion": "'0x5'", 
                    "MinorImageVersion": "'0x0'", 
                    "MinorLinkerVersion": "'0x0'", 
                    "MinorOperatingSystemVersion": "'0x0'", 
                    "MinorSubsystemVersion": "'0x0'", 
                    "NumberOfRvaAndSizes": "'0x10'", 
                    "Reserved1": "'0x0'", 
                    "SectionAlignment": "'0x1000'", 
                    "SizeOfCode": "'0xb600'", 
                    "SizeOfHeaders": "'0x400'", 
                    "SizeOfHeapCommit": "'0x1000'", 
                    "SizeOfHeapReserve": "'0x100000'", 
                    "SizeOfImage": "'0x14000'", 
                    "SizeOfInitializedData": "'0x4400'", 
                    "SizeOfStackCommit": "'0x1000'", 
                    "SizeOfStackReserve": "'0x100000'", 
                    "SizeOfUninitializedData": "'0x0'", 
                    "Subsystem": "'0x2'"
                }
            }, 
            "imports": [
                {
                    "functions": [
                        "'createdirectorya'", 
                        "'writefile'", 
                        "'createfilea'", 
                        "'deletefilea'", 
                        "'gettemppatha'", 
                        "'closehandle'", 
                        "'readfile'", 
                        "'setfilepointer'", 
                        "'createfilew'", 
                        "'getmodulefilenamew'", 
                        "'getprocaddress'", 
                        "'loadlibrarya'", 
                        "'getcommandlinea'", 
                        "'getstartupinfoa'", 
                        "'getlasterror'", 
                        "'heapfree'", 
                        "'terminateprocess'", 
                        "'getcurrentprocess'", 
                        "'unhandledexceptionfilter'", 
                        "'setunhandledexceptionfilter'", 
                        "'isdebuggerpresent'", 
                        "'entercriticalsection'", 
                        "'leavecriticalsection'", 
                        "'widechartomultibyte'", 
                        "'getconsolecp'", 
                        "'getconsolemode'", 
                        "'flushfilebuffers'", 
                        "'deletecriticalsection'", 
                        "'sethandlecount'", 
                        "'getstdhandle'", 
                        "'getfiletype'", 
                        "'rtlunwind'", 
                        "'heapalloc'", 
                        "'raiseexception'", 
                        "'getmodulehandlew'", 
                        "'sleep'", 
                        "'exitprocess'", 
                        "'getmodulefilenamea'", 
                        "'freeenvironmentstringsa'", 
                        "'getenvironmentstrings'", 
                        "'freeenvironmentstringsw'", 
                        "'getenvironmentstringsw'", 
                        "'tlsgetvalue'", 
                        "'tlsalloc'", 
                        "'tlssetvalue'", 
                        "'tlsfree'", 
                        "'interlockedincrement'", 
                        "'setlasterror'", 
                        "'getcurrentthreadid'", 
                        "'interlockeddecrement'", 
                        "'heapcreate'", 
                        "'virtualfree'", 
                        "'queryperformancecounter'", 
                        "'gettickcount'", 
                        "'getcurrentprocessid'", 
                        "'getsystemtimeasfiletime'", 
                        "'virtualalloc'", 
                        "'heaprealloc'", 
                        "'setstdhandle'", 
                        "'writeconsolea'", 
                        "'getconsoleoutputcp'", 
                        "'writeconsolew'", 
                        "'multibytetowidechar'", 
                        "'initializecriticalsectionandspincount'", 
                        "'getcpinfo'", 
                        "'getacp'", 
                        "'getoemcp'", 
                        "'isvalidcodepage'", 
                        "'heapsize'", 
                        "'lcmapstringa'", 
                        "'lcmapstringw'", 
                        "'getstringtypea'", 
                        "'getstringtypew'", 
                        "'getlocaleinfoa'", 
                        "'setendoffile'", 
                        "'getprocessheap'"
                    ], 
                    "lib": "'kernel32.dll'"
                }
            ], 
            "imports_tree": "added", 
            "packer_detection": "Unknown", 
            "packer_version": "Not_implemented", 
            "res_entries": [
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x13118'", 
                    "sha1": "4729e1050f8017aadfebbe2b1b0b9e5644d84860", 
                    "size": "'0x2e8'", 
                    "sublang": "'SUBLANG_DEFAULT'", 
                    "type": "'dBase IV DBT of @.DBF, block length 512, next free block index 40, next free block 2290649224, next used block 8947848'"
                }, 
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_ICON'", 
                    "rva": "'0x13400'", 
                    "sha1": "97f94eb4f925033211b26031977db7a0578067d1", 
                    "size": "'0x128'", 
                    "sublang": "'SUBLANG_DEFAULT'", 
                    "type": "'GLS_BINARY_LSB_FIRST'"
                }, 
                {
                    "lang": "'LANG_NEUTRAL'", 
                    "name": "'RT_GROUP_ICON'", 
                    "rva": "'0x13528'", 
                    "sha1": "1f71519f9fd81839bbfee71f16612eb5cb576499", 
                    "size": "'0x22'", 
                    "sublang": "'SUBLANG_DEFAULT'", 
                    "type": "'MS Windows icon resource - 2 icons, 32x32, 16 colors'"
                }, 
                {
                    "lang": "'LANG_ENGLISH'", 
                    "name": "'RT_MANIFEST'", 
                    "rva": "'0x1354c'", 
                    "sha1": "bac45b86a9c48fc3756a46809c101570d349737d", 
                    "size": "'0x15a'", 
                    "sublang": "'SUBLANG_ENGLISH_US'", 
                    "type": "'ASCII text, with CRLF line terminators'"
                }
            ], 
            "sections": [
                {
                    "characteristics": "0x60000020", 
                    "entropy": 6.576280245833352, 
                    "fuzzy_hash": "768:vlYOWBLZXLHrSCC4wbdzMU9hD6MECFZmWesqq75F0HFc3aKd9N5:vPWBLZrBpKdzMMHjmWFj7DB3aKd9", 
                    "md5": "cf9005030bad77c61b8c2908bc167f79", 
                    "name": "'.text\\x00\\x00\\x00'", 
                    "sha1": "48b51edd56b4c076c50b0a20f68885c2fcd8c71a", 
                    "sha2": "c0dd16171b43e59e79533d511df881227c781c08e1cbdac0e86e93e042ce6d4a", 
                    "size_raw_data": 46592, 
                    "virtual_size": 46433, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0x40000040", 
                    "entropy": 5.391913755973572, 
                    "fuzzy_hash": "192:dFx0pW/KRInvPhnnnnnnnnnnLuMkpIH3pqbC9WrXKR5:PmpU6suMZH3EWWrXKR5", 
                    "md5": "0260bfa20e7fa2db7cb7b95ef1e7f29c", 
                    "name": "'.rdata\\x00\\x00'", 
                    "sha1": "c95798bed03382a38611e86126824c722b892068", 
                    "sha2": "2e5f9c9d9432b51ab5066342e84b45c3f5cc47aca8b7f3eb41c7beb0e16a1070", 
                    "size_raw_data": 10752, 
                    "virtual_size": 10590, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0xc0000040", 
                    "entropy": 2.1659741087128968, 
                    "fuzzy_hash": "24:lOblmtzPPAtpLBuezX4jVuzfAP6uSkeK/6uSkeKlhBSqC/M+p8N0Gma:lOBmBPItTb4jVuzaTk4Tk0kR8f", 
                    "md5": "491a5f321d94799a2584f6217d0e8725", 
                    "name": "'.data\\x00\\x00\\x00'", 
                    "sha1": "cca9e9c17d2d7c855675211877704dd15265ecc8", 
                    "sha2": "4128553d8f3e433edd1b86c910ae6d0421e07cd7fc965883fdccefc835c65859", 
                    "size_raw_data": 4608, 
                    "virtual_size": 11432, 
                    "write_executable": "False"
                }, 
                {
                    "characteristics": "0x40000040", 
                    "entropy": 4.350963350655077, 
                    "fuzzy_hash": "24:Kh9EiVfffffffffySjiPPcWLsCMPgiE/jE:AfffffffffySWkWgCSCE", 
                    "md5": "e593b7c44c3df72459dd135a7382482e", 
                    "name": "'.rsrc\\x00\\x00\\x00'", 
                    "sha1": "ecd2b80be817e0299839cafba7064b70c59652a3", 
                    "sha2": "38a394e4ca32f5e9730b20d77e483897b9badc561a51540dd2410a42e6578de8", 
                    "size_raw_data": 2048, 
                    "virtual_size": 1704, 
                    "write_executable": "False"
                }
            ], 
            "strings": {
                "hidden_dll": [
                    "'user32.dll'"
                ], 
                "hidden_imports": [
                    "'getactivewindow'", 
                    "'getlastactivepopup'", 
                    "'getprocesswindowstation'", 
                    "'messageboxa'", 
                    "'winexec'"
                ], 
                "interesting": [
                    "'.exe'", 
                    "'.scr'", 
                    "'1tmp.bat'", 
                    "'1tmp.exe'"
                ], 
                "raw_strings": [
                    "'                          '", 
                    "'        <requestedexecutionlevel level='", 
                    "'      </requestedprivileges>'", 
                    "'      <requestedprivileges>'", 
                    "'    </security>'", 
                    "'    <security>'", 
                    "'  </trustinfo>'", 
                    "'  <trustinfo xmlns='", 
                    "' base class array'", 
                    "' base class descriptor at ('", 
                    "' class hierarchy descriptor'", 
                    "' complete object locator'", 
                    "' delete'", 
                    "' delete[]'", 
                    "' manifestversion='", 
                    "' new'", 
                    "' new[]'", 
                    "' runtime library'", 
                    "' type descriptor'", 
                    "' uiaccess='", 
                    "'( 8px'", 
                    "'(null)'", 
                    "', <xw'", 
                    "',-./0123456789:'", 
                    "',wpv'", 
                    "'- attempt to initialize the crt more than once.'", 
                    "'- attempt to use msil code from this assembly during native code initialization'", 
                    "'- crt not initialized'", 
                    "'- floating point support not loaded'", 
                    "'- not enough space for _onexit/atexit table'", 
                    "'- not enough space for arguments'", 
                    "'- not enough space for environment'", 
                    "'- not enough space for locale information'", 
                    "'- not enough space for lowio initialization'", 
                    "'- not enough space for stdio initialization'", 
                    "'- not enough space for thread data'", 
                    "'- pure virtual function call'", 
                    "'- unable to initialize heap'", 
                    "'- unable to open console device'", 
                    "'- unexpected heap error'", 
                    "'- unexpected multithread lock error'", 
                    "'.?avbad_alloc@std@@'", 
                    "'.?avexception@std@@'", 
                    "'.?avtype_info@@'", 
                    "'.com'", 
                    "'.exe'", 
                    "'.scr'", 
                    "'0a@@ju'", 
                    "'0sssss'", 
                    "'1tmp.bat'", 
                    "'1tmp.exe'", 
                    "'333333333333330'", 
                    "'700pp'", 
                    "'700wp'", 
                    "'8csm'", 
                    "'8vvvvv'", 
                    "'90tv'", 
                    "'9] ss'", 
                    "'9] u'", 
                    "'9]$ss'", 
                    "'9csm'", 
                    "'< tk<'", 
                    "'</assembly>papaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingxxpaddingpaddingx'", 
                    "'<=>?@abcdefghijklmnopqrstuvwxyz['", 
                    "'<at9<rt,<wt'", 
                    "'<program name unknown>'", 
                    "'<v8v'", 
                    "'></requestedexecutionlevel>'", 
                    "'>=upf'", 
                    "'>=yt1j'", 
                    "'>if90t'", 
                    "'@@f9'", 
                    "'@pwss'", 
                    "'@uws'", 
                    "'[j@j '", 
                    "'__based('", 
                    "'__cdecl'", 
                    "'__clrcall'", 
                    "'__fastcall'", 
                    "'__pascal'", 
                    "'__ptr64'", 
                    "'__restrict'", 
                    "'__stdcall'", 
                    "'__thiscall'", 
                    "'__unaligned'", 
                    "'abcdefghijklmnopqrstuvwxyz'", 
                    "'an application has made an attempt to load the c runtime library incorrectly.'", 
                    "'april'", 
                    "'asinvoker'", 
                    "'august'", 
                    "'bad allocation'", 
                    "'cc@@'", 
                    "'conout$'", 
                    "'copy constructor closure'", 
                    "'corexitprocess'", 
                    "'d$$f'", 
                    "'d$8j'", 
                    "'dddd, mmmm dd, yyyy'", 
                    "'december'", 
                    "'decodepointer'", 
                    "'default constructor closure'", 
                    "'del '", 
                    "'domain error'", 
                    "'dynamic atexit destructor for '", 
                    "'dynamic initializer for '", 
                    "'eh vector constructor iterator'", 
                    "'eh vector copy constructor iterator'", 
                    "'eh vector destructor iterator'", 
                    "'eh vector vbase constructor iterator'", 
                    "'eh vector vbase copy constructor iterator'", 
                    "'encodepointer'", 
                    "'false'", 
                    "'february'", 
                    "'flsalloc'", 
                    "'flsfree'", 
                    "'flsgetvalue'", 
                    "'flssetvalue'", 
                    "'friday'", 
                    "'fvsj'", 
                    "'getactivewindow'", 
                    "'getlastactivepopup'", 
                    "'getprocesswindowstation'", 
                    "'getuserobjectinformationa'", 
                    "'h/j@'", 
                    "'hh:mm:ss'", 
                    "'hhtxhht'", 
                    "'hhty'", 
                    "'hp.t'", 
                    "'ht$c'", 
                    "'ht(f'", 
                    "'j h8'", 
                    "'j@j '", 
                    "'janfebmaraprmayjunjulaugsepoctnovdec'", 
                    "'january'", 
                    "'july'", 
                    "'june'", 
                    "'l$ qu'", 
                    "'l$$qpwv'", 
                    "'l$,3'", 
                    "'l$,qu'", 
                    "'l$@j'", 
                    "'local static guard'", 
                    "'local static thread guard'", 
                    "'local vftable constructor closure'", 
                    "'local vftable'", 
                    "'managed vector constructor iterator'", 
                    "'managed vector copy constructor iterator'", 
                    "'managed vector destructor iterator'", 
                    "'march'", 
                    "'messageboxa'", 
                    "'microsoft visual c'", 
                    "'mm/dd/yy'", 
                    "'monday'", 
                    "'november'", 
                    "'october'", 
                    "'of@f'", 
                    "'omni callsig'", 
                    "'onpf'", 
                    "'operator'", 
                    "'ov f'", 
                    "'pa<assembly xmlns='", 
                    "'placement delete closure'", 
                    "'placement delete[] closure'", 
                    "'please contact the application'", 
                    "'ppppp'", 
                    "'pppppppp'", 
                    "'program: '", 
                    "'qrwu'", 
                    "'qsvw'", 
                    "'qswvj'", 
                    "'r6002'", 
                    "'r6008'", 
                    "'r6009'", 
                    "'r6016'", 
                    "'r6017'", 
                    "'r6018'", 
                    "'r6019'", 
                    "'r6024'", 
                    "'r6025'", 
                    "'r6026'", 
                    "'r6027'", 
                    "'r6028'", 
                    "'r6030'", 
                    "'r6031'", 
                    "'r6032'", 
                    "'r6033'", 
                    "'r6034'", 
                    "'rpsw'", 
                    "'rpvu'", 
                    "'rtti'", 
                    "'runtime error '", 
                    "'runtime error'", 
                    "'s support team for more information.'", 
                    "'s99t'", 
                    "'saturday'", 
                    "'scalar deleting destructor'", 
                    "'september'", 
                    "'sing error'", 
                    "'ss9]'", 
                    "'sssss'", 
                    "'string'", 
                    "'sunday'", 
                    "'sunmontuewedthufrisat'", 
                    "'svw3'", 
                    "'svwj'", 
                    "'svwuj'", 
                    "'t 9]'", 
                    "'t$$rqvw'", 
                    "'t$$ru'", 
                    "'t$,v-'", 
                    "'t$0ru'", 
                    "'t$h$'", 
                    "'t$lr'", 
                    "'t%hht'", 
                    "'t&:a'", 
                    "'t&:q'", 
                    "'t(9u'", 
                    "'t)9]'", 
                    "'t/9u'", 
                    "'t<:q'", 
                    "'t<vj'", 
                    "'t_8]'", 
                    "'ta9]'", 
                    "'tc9]'", 
                    "'teht1'", 
                    "'tght.ht&'", 
                    "'th9]'", 
                    "'this application has requested the runtime to terminate it in an unusual way.'", 
                    "'this indicates a bug in your application. it is most likely the result of calling an msil-compiled (/clr) function from a native constructor or from dllmain.'", 
                    "'this indicates a bug in your application.'", 
                    "'thursday'", 
                    "'ti9]'", 
                    "'tl9]'", 
                    "'tloss error'", 
                    "'tnvsp'", 
                    "'tr:q'", 
                    "'tuesday'", 
                    "'tvhtg'", 
                    "'tvpv'", 
                    "'typeof'", 
                    "'u&hp'", 
                    "'u,9e'", 
                    "'u8ss3'", 
                    "'u99u'", 
                    "'uavj'", 
                    "'udt returning'", 
                    "'uesj'", 
                    "'ul9='", 
                    "'unicode'", 
                    "'unknown exception'", 
                    "'unsw'", 
                    "'uqpxy]y['", 
                    "'urn:schemas-microsoft-com:asm.v1'", 
                    "'urn:schemas-microsoft-com:asm.v3'", 
                    "'urpqqh'", 
                    "'user32.dll'", 
                    "'utf-16le'", 
                    "'utf-8'", 
                    "'uvws'", 
                    "'vbase destructor'", 
                    "'vbtable'", 
                    "'vcall'", 
                    "'vector constructor iterator'", 
                    "'vector copy constructor iterator'", 
                    "'vector deleting destructor'", 
                    "'vector destructor iterator'", 
                    "'vector vbase constructor iterator'", 
                    "'vector vbase copy constructor iterator'", 
                    "'vftable'", 
                    "'virtual displacement map'", 
                    "'vvhu'", 
                    "'vvvvv'", 
                    "'vw9]'", 
                    "'wednesday'", 
                    "'winexec'", 
                    "'wivsp'", 
                    "'wsj '", 
                    "'wsj0'", 
                    "'wwvpv'", 
                    "'wwwwv'", 
                    "'wwwww'", 
                    "'wwwwwww'", 
                    "'xppwpp'", 
                    "'xpxxxx'", 
                    "'yqpvh'"
                ]
            }, 
            "version": {}
        }, 
        "size": 121373
    }, 
    "attack-pattern": [
        {
            "created": "2017-05-31T21:30:31.197Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Adversaries may use a custom cryptographic protocol or algorithm to hide command and control traffic. A simple scheme, such as XOR-ing the plaintext with a fixed key, will produce a very weak ciphertext.\n\nCustom encryption schemes may vary in sophistication. Analysis and reverse engineering of malware samples may be enough to discover the algorithm and encryption key used.\n\nSome adversaries may also attempt to implement their own version of a well-known cryptographic algorithm instead of using a known implementation library, which may lead to unintentional errors. (Citation: F-Secure Cosmicduke)\n\nDetection: If malware uses custom encryption with symmetric keys, it may be possible to obtain the algorithm and key from samples and use them to decode network traffic to detect malware communications signatures. (Citation: Fidelis DarkComet)\n\nIn general, analyze network data for uncommon data flows (e.g., a client sending significantly more data than it receives from a server). Processes utilizing the network that do not normally have network communication or have never been seen before are suspicious. Analyze packet contents to detect when communications do not follow the expected protocol behavior for the port that is being used. (Citation: University of Birmingham C2)\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: Packet capture, Netflow/Enclave netflow, Process use of network, Malware reverse engineering, Process monitoring\n\nRequires Network: Yes", 
            "external_references": [
                {
                    "external_id": "T1024", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1024"
                }, 
                {
                    "description": "F-Secure Labs. (2014, July). COSMICDUKE Cosmu with a twist of MiniDuke. Retrieved July 3, 2014.", 
                    "source_name": "F-Secure Cosmicduke", 
                    "url": "https://www.f-secure.com/documents/996508/1030745/cosmicduke%20whitepaper.pdf"
                }, 
                {
                    "description": "Gardiner, J.,  Cova, M., Nagaraja, S. (2014, February). Command & Control Understanding, Denying and Detecting. Retrieved April 20, 2016.", 
                    "source_name": "University of Birmingham C2", 
                    "url": "https://arxiv.org/ftp/arxiv/papers/1408/1408.1136.pdf"
                }, 
                {
                    "description": "Fidelis Cybersecurity. (2015, August 4). Looking at the Sky for a DarkComet. Retrieved April 5, 2016.", 
                    "source_name": "Fidelis DarkComet", 
                    "url": "https://www.fidelissecurity.com/sites/default/files/FTA%201018%20looking%20at%20the%20sky%20for%20a%20dark%20comet.pdf"
                }
            ], 
            "id": "attack-pattern--3b3cbbe0-6ed3-4334-b543-3ddfd8c5642d", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "command-and-control"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Custom Cryptographic Protocol", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_data_sources": [
                "Packet capture", 
                "Netflow/Enclave netflow", 
                "Process use of network", 
                "Malware reverse engineering", 
                "Process monitoring"
            ], 
            "x_mitre_network_requirements": true, 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }, 
        {
            "created": "2017-05-31T21:30:47.843Z", 
            "created_by_ref": "identity--c78cb6e5-0c4b-4611-8297-d1b8b55e40b5", 
            "description": "Process injection is a method of executing arbitrary code in the address space of a separate live process. Running code in the context of another process may allow access to the process's memory, system/network resources, and possibly elevated privileges. Execution via process injection may also evade detection from security products since the execution is masked under a legitimate process.\n\n===Windows===\n\nThere are multiple approaches to injecting code into a live process. Windows implementations include: (Citation: Engame Process Injection July 2017)\n* '''Dynamic-link library (DLL) injection''' involves writing the path to a malicious DLL inside a process then invoking execution by creating a remote thread.\n* '''Portable executable injection''' involves writing malicious code directly into the process (without a file on disk) then invoking execution with either additional code or by creating a remote thread. The displacement of the injected code introduces the additional requirement for functionality to remap memory references. Variations of this method such as reflective DLL injection (writing a self-mapping DLL into a process) and memory module (map DLL when writing into process) overcome the address relocation issue. (Citation: Endgame HuntingNMemory June 2017)\n* '''Thread execution hijacking''' involves injecting malicious code or the path to a DLL into a thread of a process. Similar to Process Hollowing, the thread must first be suspended.\n* '''Asynchronous Procedure Call''' (APC) injection involves attaching malicious code to the APC Queue (Citation: Microsoft APC) of a process's thread. Queued APC functions are executed when the thread enters an alterable state. AtomBombing  (Citation: ENSIL AtomBombing Oct 2016) is a variation that utilizes APCs to invoke malicious code previously written to the global atom table. (Citation: Microsoft Atom Table)\n* '''Thread Local Storage''' (TLS) callback injection involves manipulating pointers inside a portable executable (PE) to redirect a process to malicious code before reaching the code's legitimate entry point. (Citation: FireEye TLS Nov 2017)\n\n===Mac and Linux===\n\nImplementations for Linux and OS X/macOS systems include: (Citation: Datawire Code Injection) (Citation: Uninformed Needle)\n*'''LD_PRELOAD, LD_LIBRARY_PATH''' (Linux), '''DYLD_INSERT_LIBRARIES''' (Mac OS X) environment variables, or the dlfcn application programming interface (API) can be used to dynamically load a library (shared object) in a process which can be used to intercept API calls from the running process. (Citation: Phrack halfdead 1997)\n*'''Ptrace system calls''' can be used to attach to a running process and modify it in runtime. (Citation: Uninformed Needle)\n*'''/proc/[pid]/mem''' provides access to the memory of the process and can be used to read/write arbitrary data to it. This technique is very rare due to its complexity. (Citation: Uninformed Needle)\n*'''VDSO hijacking''' performs runtime injection on ELF binaries by manipulating code stubs mapped in from the linux-vdso.so shared object. (Citation: VDSO hijack 2009)\n\nMalware commonly utilizes process injection to access system resources through which Persistence and other environment modifications can be made. More sophisticated samples may perform multiple process injections to segment modules and further evade detection, utilizing named pipes or other inter-process communication (IPC) mechanisms as a communication channel.\n\nDetection: Monitoring Windows API calls indicative of the various types of code injection may generate a significant amount of data and may not be directly useful for defense unless collected under specific circumstances for known bad sequences of calls, since benign use of API functions may be common and difficult to distinguish from malicious behavior. API calls such as CreateRemoteThread, SuspendThread/SetThreadContext/ResumeThread, QueueUserAPC, and those that can be used to modify memory within another process, such as WriteProcessMemory, may be used for this technique. (Citation: Engame Process Injection July 2017)\n\nMonitoring for Linux specific calls such as the ptrace system call, the use of LD_PRELOAD environment variable, or dlfcn dynamic linking API calls, should not generate large amounts of data due to their specialized nature, and can be a very effective method to detect some of the common process injection methods.  (Citation: ArtOfMemoryForensics)  (Citation: GNU Acct)  (Citation: RHEL auditd)  (Citation: Chokepoint preload rootkits)\n\nMonitor for named pipe creation and connection events (Event IDs 17 and 18) for possible indicators of infected processes with external modules. (Citation: Microsoft Sysmon v6 May 2017)\n\nMonitor processes and command-line arguments for actions that could be done before or after code injection has occurred and correlate the information with related event information. Code injection may also be performed using PowerShell with tools such as PowerSploit, (Citation: Powersploit) so additional PowerShell monitoring may be required to cover known implementations of this behavior.\n\nPlatforms: Linux, macOS, Windows\n\nData Sources: API monitoring, Windows Registry, File monitoring, DLL monitoring, Named Pipes, Process Monitoring\n\nEffective Permissions: User, Administrator, SYSTEM, root\n\nDefense Bypassed: Process whitelisting, Anti-virus\n\nPermissions Required: User, Administrator, SYSTEM, root\n\nContributors: Anastasios Pingios", 
            "external_references": [
                {
                    "external_id": "T1055", 
                    "source_name": "mitre-attack", 
                    "url": "https://attack.mitre.org/wiki/Technique/T1055"
                }, 
                {
                    "description": "PowerSploit. (n.d.).  Retrieved December 4, 2014.", 
                    "source_name": "Powersploit", 
                    "url": "https://github.com/mattifestation/PowerSploit"
                }, 
                {
                    "description": "Hosseini, A. (2017, July 18). Ten Process Injection Techniques: A Technical Survey Of Common And Trending Process Injection Techniques. Retrieved December 7, 2017.", 
                    "source_name": "Engame Process Injection July 2017", 
                    "url": "https://www.endgame.com/blog/technical-blog/ten-process-injection-techniques-technical-survey-common-and-trending-process"
                }, 
                {
                    "description": "Desimone, J. (2017, June 13). Hunting in Memory. Retrieved December 7, 2017.", 
                    "source_name": "Endgame HuntingNMemory June 2017", 
                    "url": "https://www.endgame.com/blog/technical-blog/hunting-memory"
                }, 
                {
                    "description": "Microsoft. (n.d.). Asynchronous Procedure Calls. Retrieved December 8, 2017.", 
                    "source_name": "Microsoft APC", 
                    "url": "https://msdn.microsoft.com/library/windows/desktop/ms681951.aspx"
                }, 
                {
                    "description": "Liberman, T. (2016, October 27). ATOMBOMBING: BRAND NEW CODE INJECTION FOR WINDOWS. Retrieved December 8, 2017.", 
                    "source_name": "ENSIL AtomBombing Oct 2016", 
                    "url": "https://blog.ensilo.com/atombombing-brand-new-code-injection-for-windows"
                }, 
                {
                    "description": "Microsoft. (n.d.). About Atom Tables. Retrieved December 8, 2017.", 
                    "source_name": "Microsoft Atom Table", 
                    "url": "https://msdn.microsoft.com/library/windows/desktop/ms649053.aspx"
                }, 
                {
                    "description": "Vaish, A. & Nemes, S. (2017, November 28). Newly Observed Ursnif Variant Employs Malicious TLS Callback Technique to Achieve Process Injection. Retrieved December 18, 2017.", 
                    "source_name": "FireEye TLS Nov 2017", 
                    "url": "https://www.fireeye.com/blog/threat-research/2017/11/ursnif-variant-malicious-tls-callback-technique.html"
                }, 
                {
                    "description": "Turner-Trauring, I. (2017, April 18). \u201cThis will only hurt for a moment\u201d: code injection on Linux and macOS with LD_PRELOAD. Retrieved December 20, 2017.", 
                    "source_name": "Datawire Code Injection", 
                    "url": "https://www.datawire.io/code-injection-on-linux-and-macos/"
                }, 
                {
                    "description": "skape. (2003, January 19). Linux x86 run-time process manipulation. Retrieved December 20, 2017.", 
                    "source_name": "Uninformed Needle", 
                    "url": "http://hick.org/code/skape/papers/needle.txt"
                }, 
                {
                    "description": "halflife. (1997, September 1). Shared Library Redirection Techniques. Retrieved December 20, 2017.", 
                    "source_name": "Phrack halfdead 1997", 
                    "url": "http://phrack.org/issues/51/8.html"
                }, 
                {
                    "description": "O'Neill, R. (2009, May). Modern Day ELF Runtime infection via GOT poisoning. Retrieved December 20, 2017.", 
                    "source_name": "VDSO hijack 2009", 
                    "url": "http://vxer.org/lib/vrn00.html"
                }, 
                {
                    "description": "Ligh, M.H. et al.. (2014, July). The Art of Memory Forensics: Detecting Malware and Threats in Windows, Linux, and Mac Memory. Retrieved December 20, 2017.", 
                    "source_name": "ArtOfMemoryForensics"
                }, 
                {
                    "description": "GNU. (2010, February 5). The GNU Accounting Utilities. Retrieved December 20, 2017.", 
                    "source_name": "GNU Acct", 
                    "url": "https://www.gnu.org/software/acct/"
                }, 
                {
                    "description": "Jahoda, M. et al.. (2017, March 14). redhat Security Guide - Chapter 7 - System Auditing. Retrieved December 20, 2017.", 
                    "source_name": "RHEL auditd", 
                    "url": "https://access.redhat.com/documentation/red%20hat%20enterprise%20linux/6/html/security%20guide/chap-system%20auditing"
                }, 
                {
                    "description": "stderr. (2014, February 14). Detecting Userland Preload Rootkits. Retrieved December 20, 2017.", 
                    "source_name": "Chokepoint preload rootkits", 
                    "url": "http://www.chokepoint.net/2014/02/detecting-userland-preload-rootkits.html"
                }, 
                {
                    "description": "Russinovich, M. & Garnier, T. (2017, May 22). Sysmon v6.20. Retrieved December 13, 2017.", 
                    "source_name": "Microsoft Sysmon v6 May 2017", 
                    "url": "https://docs.microsoft.com/sysinternals/downloads/sysmon"
                }
            ], 
            "id": "attack-pattern--43e7dc91-05b2-474c-b9ac-2ed4fe101f4d", 
            "kill_chain_phases": [
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "defense-evasion"
                }, 
                {
                    "kill_chain_name": "mitre-attack", 
                    "phase_name": "privilege-escalation"
                }
            ], 
            "modified": "2018-04-18T17:59:24.739Z", 
            "name": "Process Injection", 
            "object_marking_refs": [
                "marking-definition--fa42a846-8d90-4e51-bc29-71d5b4802168"
            ], 
            "type": "attack-pattern", 
            "x_mitre_contributors": [
                "Anastasios Pingios"
            ], 
            "x_mitre_data_sources": [
                "API monitoring", 
                "Windows Registry", 
                "File monitoring", 
                "DLL monitoring", 
                "Named Pipes", 
                "Process Monitoring"
            ], 
            "x_mitre_defense_bypassed": [
                "Process whitelisting", 
                "Anti-virus"
            ], 
            "x_mitre_effective_permissions": [
                "User", 
                "Administrator", 
                "SYSTEM", 
                "root"
            ], 
            "x_mitre_permissions_required": [
                "User", 
                "Administrator", 
                "SYSTEM", 
                "root"
            ], 
            "x_mitre_platforms": [
                "Linux", 
                "macOS", 
                "Windows"
            ]
        }
    ], 
    "hash": "ef76f849c8ec7d3b9ce951460e45e061bbde2cbd2563d61defbf32b956c0e9ad", 
    "name": "Taidoor"
}